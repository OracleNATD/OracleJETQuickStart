/**
 * Copyright (c) 2014, 2016, Oracle and/or its affiliates.
 * The Universal Permissive License (UPL), Version 1.0
 */
"use strict";
define(["ojs/ojcore","jquery","promise"],function(a,g){a.ka=a.Events={on:function(a,c,d){return this.Xp(a,c,d,!1,!1)},off:function(a,c,d){return this.sV(a,c,d,!1)},trigger:function(b){var c=Array.prototype.slice.call(arguments);c.unshift(!1);return a.ka.Lc.apply(this,c)},once:function(a,c,d){return this.Baa(a,c,d,!1,null)},listenTo:function(b,c,d){var e,f,h,k,g={};c.constructor===String?g[c]=d:g=c;for(k in g)if(g.hasOwnProperty(k))for(c=a.ka.xv(k),d=0;d<c.length;d+=1)e=c[d].event,f=c[d].ha,h={event:e,
ha:f,object:b,Oc:g[k]},this.CR(this._listeningTo,h,a.ka.U$),e=f?e+":"+f:e,void 0===this._listeningTo&&(this._listeningTo=[]),this._listeningTo.push(h),b.Xp(e,g[k],null,!0,!1);return this},listenToOnce:function(b,c,d){var e,f,h,k,g={};c.constructor===String?g[c]=d:g=c;for(k in g)if(g.hasOwnProperty(k))for(c=a.ka.xv(k),d=0;d<c.length;d+=1)e=c[d].event,f=c[d].ha,h={event:e,ha:f,object:b,Oc:g[k]},this.CR(this._listeningTo,h,a.ka.U$),e=f?e+":"+f:e,void 0===this._listeningTo&&(this._listeningTo=[]),this._listeningTo.push(h),
b.Baa(e,g[k],null,!0,this);return this},stopListening:function(b,c,d){var e,f={},h,k,g,m,r,t,s,q,p;if(null==arguments||1>=arguments.length){t=this._listeningTo?this._listeningTo.length:0;for(q=0;q<t;q++)if(m=this._listeningTo[q],r=b?b===m.object:!0)r=m.object.sV,r.apply(m.object,[m.event,m.Oc,m.context,!0]);this._listeningTo=[];return this}e=c;b&&b.constructor===String&&(e=b);e.constructor===String?f[e]=d:f=e;for(p in f)if(f.hasOwnProperty(p))for(e=a.ka.xv(p),h=0;h<e.length;h+=1)for(k=e[h].event,
g=e[h].ha,t=this._listeningTo?this._listeningTo.length:0,q=t-1;0<=q;q-=1)m=this._listeningTo[q],r=b?b===m.object:!0,t=k?k===m.event:!0,s=d?f[p]===m.Oc:!0,m=g?g===m.ha:!0,r&&t&&s&&m&&(r=this._listeningTo[q].object.sV,r.apply(this._listeningTo[q].object,[this._listeningTo[q].event,this._listeningTo[q].Oc,this._listeningTo[q].context,!0]),this._listeningTo.splice(q,1));return this}};a.ka.bind=a.ka.on;a.ka.unbind=a.ka.off;a.ka.O={ADD:"add",ALLADDED:"alladded",REMOVE:"remove",RESET:"reset",REFRESH:"refresh",
SORT:"sort",CHANGE:"change",DESTROY:"destroy",ALLREMOVED:"allremoved",REQUEST:"request",SYNC:"sync",ERROR:"error",INVALID:"invalid",READY:"ready",ALL:"all"};o_("Events.EventType",a.ka.O,a);a.ka.XO=function(a,c){var d,e=c||this;for(d in e)"function"===typeof e[d]&&(a[d]=e[d]);a.Pe={};a._listeningTo=[]};a.ka.Baa=function(a,c,d,e,f){var h,k,g,m;g=this.gT(a,c);for(m in g)if(g.hasOwnProperty(m))for(a=this.xv(m),c=0;c<a.length;c+=1)h=a[c].event,k=a[c].ha,void 0===this.Pe&&(this.Pe=[]),void 0===this.Pe[h]&&
(this.Pe[h]=[]),this.Pe[h].push({Oc:g[m],context:d,ha:k,Ar:!0,fired:!1,Kt:e,gG:f});return this};a.ka.bda=function(a){return a.Ar?a.fired?!1:a.fired=!0:!0};a.ka.n7=function(a,c){return c.context||c.gG||a};a.ka.Lc=function(b,c){var d=this.xv(c),e,f,h,k,g,m;k=[];for(e=0;e<d.length;e+=1)f=d[e].event,h=d[e].ha,k.push({event:f,ha:h});for(e=0;e<k.length;e+=1){g=this.nJ(this.Pe,a.ka.O.ALL);d=a.ka.nJ(this.Pe,k[e].event,!1);for(f=0;f<(d?d.length:0);f+=1)d[f].ha===k[e].ha&&d[f].Oc&&(h=Array.prototype.slice.call(arguments),
d&&d[f]&&d[f].Ar&&(this.Fba(a.ka.nJ(this.Pe,k[e].event,!0),d[f]),d[f].gG&&d[f].gG.stopListening(this,c,d[f].Oc)),d&&d[f]&&this.bda(d[f])&&(m=d[f].Oc,b&&!d[f].iha||m.apply(a.ka.n7(this,d[f]),h.slice(2))));for(f=0;f<(g?g.length:0);f+=1)h=Array.prototype.slice.call(arguments),0<h.length&&(h[1]=k[e].ha?k[e].event+":"+k[e].ha:k[e].event),g&&g[f]&&g[f].Oc&&this.bda(g[f])&&(m=g[f].Oc,b&&!g[f].iha||m.apply(a.ka.n7(this,g[f]),h.slice(1))),g&&g[f]&&g[f].Ar&&(this.Fba(this.nJ(this.Pe,a.ka.O.ALL,!0),g[f]),g[f].gG&&
g[f].gG.stopListening(this,a.ka.O.ALL,g[f].Oc))}return this};a.ka.Xp=function(b,c,d,e,f){var h,k,g,m;b=this.gT(b,c);for(h in b)if(b.hasOwnProperty(h))for(c=this.xv(h),k=0;k<c.length;k+=1)g=c[k].event,m=c[k].ha,void 0===this.Pe&&(this.Pe=[]),void 0===this.Pe[g]&&(this.Pe[g]=[]),m={Oc:b[h],context:d,ha:m,Kt:e,iha:f},-1===this.CR(this.Pe[g],m,a.ka.Ixa)&&this.Pe[g].push(m);return this};a.ka.sV=function(a,c,d,e){var f,h;if(null==arguments||0==arguments.length)return this.Pe={},this;if(null==a)return this.Eba(a,
c,d,e),this;f=this.gT(a,c);for(h in f)f.hasOwnProperty(h)&&this.Eba(h,f[h],d,e);return this};a.ka.gT=function(a,c){var d={};a.constructor===String?d[a]=c:d=a;return d};a.ka.Eba=function(b,c,d,e){var f=[],h,k,g,m,r,t,s,q;if(b)f=a.ka.xv(b);else if(void 0!==this.Pe)for(k in this.Pe)this.Pe.hasOwnProperty(k)&&f.push({event:k});for(b=0;b<f.length;b+=1)if(k=f[b].event,g=f[b].ha,void 0!==this.Pe&&this.Pe[k]instanceof Array){m=this.Pe[k];for(h=m.length-1;0<=h;h-=1)r=void 0===c||null===c||m[h].Oc==c,t=void 0===
d||null===d||m[h].context==d,s=void 0===g||null===g||m[h].ha==g,q=void 0===e||null===e||m[h].Kt==e,r&&t&&s&&q&&m.splice(h,1);0===m.length&&delete this.Pe[k]}};a.ka.Fba=function(a,c){var d,e,f,h,k,g;if(a)for(d=a.length-1;0<=d;d-=1)e=void 0===c.Oc||null===c.Oc||a[d].Oc==c.Oc,f=void 0===c.context||null===c.context||a[d].context==c.context,h=void 0===c.ha||null===c.ha||a[d].ha==c.ha,k=void 0===c.Kt||null===c.Kt||a[d].Kt==c.Kt,g=void 0===c.Ar||null===c.Ar||a[d].Ar==c.Ar,e&&f&&h&&k&&g&&a.splice(d,1)};a.ka.xv=
function(a){a=a?a.split(" "):[];var c=[],d,e,f;for(d=0;d<a.length;d+=1)e=a[d].split(":"),f=e[0],e=1<e.length?e[1]:null,c.push({event:f,ha:e});return c};a.ka.Ixa=function(a,c){return a.Oc===c.Oc&&a.ha===c.ha&&a.context===c.context&&a.Kt===c.Kt&&a.Ar===c.Ar};a.ka.U$=function(a,c){return a.event===c.event&&a.ha===c.ha&&a.context===c.context&&a.object===c.object};a.ka.CR=function(a,c,d){var e;if(void 0===a)return-1;for(e=0;e<a.length;e+=1)if(d(a[e],c))return e;return-1};a.ka.nJ=function(a,c,d){if(a&&
a[c]instanceof Array){if(d)return a[c];d=[];var e;for(e=0;e<a[c].length;e++)d.push(a[c][e]);return d}return null};a.D=function(b,c){a.D._init(this,b,c,null)};o_("Model",a.D,a);a.b.sa(a.D,a.b,"oj.Model");a.D.prototype.Init=function(){a.D.u.Init.call(this)};a.D.prototype.attributes={};a.b.g("Model.prototype.attributes",{attributes:a.D.prototype.attributes});a.D.prototype.Zc={};a.b.g("Model.prototype.defaults",{Zc:a.D.prototype.Zc});a.D.prototype.id=null;a.b.g("Model.prototype.id",{id:a.D.prototype.id});
a.D.prototype.hha="id";a.b.g("Model.prototype.idAttribute",{hha:a.D.prototype.hha});a.D.prototype.gka=null;a.b.g("Model.prototype.urlRoot",{gka:a.D.prototype.gka});a.D.prototype.En=null;a.b.g("Model.prototype.customURL",{En:a.D.prototype.En});a.D.EU=0;a.D._init=function(b,c,d,e){var f=null,h;if(!a.D.JD){b.Init();a.ka.XO(b);b.ty();b.UZ={};b.LN=!1;b.index=-1;d=d||{};b.attributes={};b.defaults&&!d.UIa&&(b.attributes=a.D.oI(g.isFunction(b.defaults)?b.defaults():b.defaults,null));for(f in e)e.hasOwnProperty(f)&&
(b[f]=e[f]);if(c)if(e=d.parse,g.isFunction(e)&&(b.parse=e),h=a.D.oI(c,b.attributes),h=e?b.parse(h):h,null==h||void 0===h)b.attributes={};else for(f in h)h.hasOwnProperty(f)&&b.tW(f,h[f],!1,!1,d);b.TG();b.AB(d.collection);d.customURL&&(b.customURL=d.customURL);d.url&&(b.url=d.url);d.urlRoot&&(b.urlRoot=d.urlRoot);b.initialize&&b.initialize(c,d);b.jo()}};a.D.extend=function(b,c){a.D.JD=!0;var d,e;d=new a.D;a.D.JD=!1;g.extend(d,this.prototype);b=b||{};for(e in b)b.hasOwnProperty(e)&&(d[e]=b[e]);var f;
f=b&&b.constructor&&b.hasOwnProperty("constructor")?b.constructor:function(c,d){a.D._init(this,c,d,b)};g.extend(f,this);f.prototype=d;f.extend=a.D.extend;f.prototype.constructor=f;a.ka.XO(f,this);if(c)for(e in c)c.hasOwnProperty(e)&&(f[e]=c[e]);return f};o_("Model.extend",a.D.extend,a);a.D.prototype.Lc=function(){};a.D.prototype.TG=function(){this.Bu()||(this.cid="id"+a.D.EU,a.D.EU+=1)};a.D.prototype.Bu=function(){return this.cid};a.D.prototype.BB=function(a){this.index=a};a.D.prototype.Oka=function(){return this.index};
a.D.prototype.iP=function(a){this.NJa=a};a.D.prototype.UG=function(a){var c=this.VZ;this.VZ=a;return c};a.D.prototype.ela=function(b,c,d){var e,f=!1,h=a.cb.Re(c),k,g=!1;for(e in b.attributes)b.attributes.hasOwnProperty(e)&&(k=this.attributes[e]!=b.attributes[e],h?e===c&&k&&(f=!0):k&&(f=!0),k&&(g=!0,this.attributes[e]=b.attributes[e],this.QQ(e,b.attributes[e]),this.RI(e,this.attributes[e],null,d)));this.jo();g&&this.SI(null,d);return f};a.D.VJ=function(a){var c;if(a&&a instanceof Object)for(c in a)if(a.hasOwnProperty(c))return!0;
return!1};a.D.prototype.AB=function(a){null==a?delete this.collection:(this.collection=a,this.jo())};a.D.prototype.nB=function(){return this.collection};a.D.prototype.RI=function(b,c,d,e){null!=b&&this.Lc(e,a.ka.O.CHANGE+":"+b,this,c,d)};a.D.prototype.SI=function(b,c){this.Lc(c,a.ka.O.CHANGE,this,b,null)};a.D.prototype.jo=function(){var a=null;this.collection&&this.collection.modelId&&(a=this.collection.modelId,a=g.isFunction(a)?a.call(this.collection,this.attributes):a);a||(a=this.lT(),a=null!=this.attributes?
this.attributes[a]:null);this.id=a};a.D.prototype.yDa=function(b,c,d){var e=a.b.dC(this.attributes[b],c);return d||!e?(this.attributes[b]=c,this.jo(),!e):!1};a.D.prototype.ty=function(){this.changed={}};a.D.prototype.QQ=function(a,c){this.changed[a]=c};a.D.prototype.tW=function(b,c,d,e,f){if(null==b)return!0;var h={},k,g=this.LN;if(e)for(k in b)b.hasOwnProperty(k)&&(h[k]=b[k]);else h[b]=c;b=f||{};if(!this.vC(h,{validate:b.validate},!1))return!1;g||(this.ty(),this.wt=[]);this.LN||(this.UZ=a.D.oI(this.attributes,
null));this.LN=!0;for(k in h)h.hasOwnProperty(k)&&(this.yDa(k,h[k],d)?(this.QQ(k,h[k]),this.wt.push(k)):delete h[k]);d=b.silent;for(k in h)h.hasOwnProperty(k)&&(!d&&(0<this.wt.length||g&&-1===this.wt.indexOf(k))&&(this.Dia=!0,this.YJa=b),this.RI(k,h[k],b,d));if(g)return!0;if(!d&&!g)for(;this.Dia;)this.Dia=!1,this.SI(this.YJa,d);this.LN=!1;return!0};a.D.prototype.clear=function(b){var c,d={silent:!0},e;b=b||{};e=b.silent;d.validate=b.validate;this.ty();for(c in this.attributes)if(this.attributes.hasOwnProperty(c)){if(!this.FL(c,
d,!0))return!1;this.Lc(e,a.ka.O.CHANGE+":"+c,this,void 0,null)}this.attributes={};this.jo();this.RI(null,null,null,e);this.SI(null,e);return this};a.b.g("Model.prototype.clear",{clear:a.D.prototype.clear});a.D.oI=function(b,c){c=c||{};for(var d in b)c.hasOwnProperty(d)&&b.hasOwnProperty(d)&&void 0===b[d]&&delete b[d];a.Xc.vf(c,b,void 0,!0,1E4);return c};a.D.prototype.clone=function(){var b=new this.constructor,c;for(c in this)this.hasOwnProperty(c)&&this[c]!==this.attributes&&(b[c]=this[c]);b.attributes=
a.D.oI(this.attributes,null);delete b.cid;b.TG();b.jo();return b};a.b.g("Model.prototype.clone",{clone:a.D.prototype.clone});a.D.prototype.Hu=function(a,c){var d=this.Li();if(void 0!==d&&d==a)return!0;d=this.cid;return void 0!==d&&d==c?!0:!1};a.D.prototype.set=function(b,c,d){var e=d||{},f,h=!0;if(arguments&&0<arguments.length)if(a.cb.Re(b))e.unset?this.FL(b,null,!1):this.tW(b,c,!1,!1,e)||(h=!1);else if(e=c||{},e.unset)for(f in b)b.hasOwnProperty(f)&&this.FL(f,null,!1);else this.tW(b,null,!0,!0,e)||
(h=!1);return h?this:!1};a.b.g("Model.prototype.set",{set:a.D.prototype.set});a.D.prototype.eka=function(a,c){return this.FL(a,c,!1)};a.b.g("Model.prototype.unset",{eka:a.D.prototype.eka});a.D.prototype.FL=function(a,c,d){c=c||{};var e=c.silent,f={};if(this.has(a)){if(!this.vC(f,c,!1))return!1;d||this.ty();delete this.attributes[a];this.QQ(a,void 0);this.RI(a,null,null,e);this.SI(null,e)}this.jo();return!0};a.D.prototype.get=function(a){return this.attributes[a]};a.b.g("Model.prototype.get",{get:a.D.prototype.get});
a.D.prototype.has=function(b){return a.l.tq(this.attributes[b])};a.b.g("Model.prototype.has",{has:a.D.prototype.has});a.D.prototype.fetch=function(b){b=b||{};var c=b.success,d=b.error,e=this,f;f=a.D.jv(b);f.error=function(c,f,g){a.D.PE(e,!1,b,f,g,c);d&&d.apply(e,arguments)};f.success=function(d){f.xhr&&(b.xhr=f.xhr);a.D.VI(e,d,f);g.isFunction(e.parse)&&e.set(e.parse(d),f);c&&c.call(a.D.yl(f,e),e,d,b)};return a.D.xD("read",this,f)};a.b.g("Model.prototype.fetch",{fetch:a.D.prototype.fetch});a.D.prototype.parse=
function(a){return a};a.D.prototype.url=function(){var b=this.O8(),c=this.Li();if(b)return c?b+"/"+encodeURIComponent(c):b;if(b=this.collection)return b=a.D.Qr(b,"url"),c&&b?(c="/"==a.D.Eua(b)?"":"/",b+c+encodeURIComponent(this.Li())):b;throw new a.Vr;};a.b.g("Model.prototype.url",{url:a.D.prototype.url});a.D.prototype.keys=function(){var a,c=[];for(a in this.attributes)this.attributes.hasOwnProperty(a)&&c.push(a);return c};a.b.g("Model.prototype.keys",{keys:a.D.prototype.keys});a.D.prototype.ika=
function(){var a,c=[];for(a in this.attributes)this.attributes.hasOwnProperty(a)&&c.push(this.get(a));return c};a.b.g("Model.prototype.values",{ika:a.D.prototype.ika});a.D.prototype.Bia=function(){var a,c=[],d;for(a in this.attributes)this.attributes.hasOwnProperty(a)&&(d=[],d.push(a),d.push(this.get(a)),c.push(d));return c};a.b.g("Model.prototype.pairs",{Bia:a.D.prototype.Bia});a.D.prototype.xia=function(a){var c=[],d,e,f={};if(a instanceof Array)c=a;else for(d=0;d<arguments.length;d++)c.push(arguments[d]);
for(e in this.attributes)this.attributes.hasOwnProperty(e)&&-1==c.indexOf(e)&&(f[e]=this.get(e));return f};a.b.g("Model.prototype.omit",{xia:a.D.prototype.xia});a.D.prototype.Eia=function(a){var c=[],d,e={};if(a instanceof Array)c=a;else for(d=0;d<arguments.length;d++)c.push(arguments[d]);for(d=0;d<c.length;d++)this.attributes.hasOwnProperty(c[d])&&(e[c[d]]=this.get(c[d]));return e};a.b.g("Model.prototype.pick",{Eia:a.D.prototype.Eia});a.D.prototype.oha=function(){var a,c={},d;for(a in this.attributes)this.attributes.hasOwnProperty(a)&&
(d=this.get(a),c[d]=a);return c};a.b.g("Model.prototype.invert",{oha:a.D.prototype.oha});a.D.Eua=function(a){return a.charAt(a.length-1)};a.D.prototype.FCa=function(){var a=this.O8();return a?a:this.nB()?this.nB().url:null};a.D.prototype.O8=function(){return a.D.Qr(this,"urlRoot")};a.D.prototype.parseSave=function(a){return a};a.D.prototype.isValid=function(){var a={};a.validate=this.validate;return this.vC(this.attributes,a,!1)};a.b.g("Model.prototype.isValid",{isValid:a.D.prototype.isValid});a.D.fza=
function(a,c){a=a||{};return void 0!==a.validate&&null!==a.validate?a.validate:c};a.D.prototype.vC=function(b,c,d){c=c||{};var e=this.validate;return e&&a.D.fza(c,d)&&(this.validationError=e.call(this,b,c))?(this.Lc(!1,a.ka.O.INVALID,this,this.validationError,c),!1):!0};a.D.SAa=function(b){var c=!1,d={},e,f={};if(b&&0<b.length){1<b.length&&b[b.length-1]&&a.D.VJ(b[b.length-1])&&(c=!0,d=b[b.length-1]||{});if(null==b[0])return{attributes:null,options:d};if(a.D.VJ(b[0])||a.b.xi(b[0]))for(e in b[0])b[0].hasOwnProperty(e)&&
(f[e]=b[0][e]);else for(e=0;e<b.length;e+=2)if(void 0!==b[e]||e<b.length-1||!c&&e===b.length-1)f[b[e]]=b[e+1]}return{attributes:f,options:d}};a.D.jv=function(a){var c={},d;a=a||{};for(d in a)a.hasOwnProperty(d)&&(c[d]=a[d]);return c};a.D.PE=function(b,c,d,e,f,h){d=d||{};d.textStatus=e;d.errorThrown=f;b.Lc(c,a.ka.O.ERROR,b,h,d)};a.D.prototype.save=function(b,c){var d,e,f,h,k,l;d=a.D.SAa(arguments);var m,r,t;t=void 0===b?void 0:d.attributes;c=c||{};m=a.D.jv(d.options);if(!this.vC(this.attributes,m,
!0))return!1;m.wait||this.set(t);d=void 0===m.forceNew?!1:m.forceNew;h=this;k=m.error;l=m.patch;m.error=function(b,d,e){a.D.PE(h,!1,c,d,e,b);k&&k.apply(h,arguments)};m.saveAttrs=m.wait?this.Gpa(t):this.attributes;r=this.attributes;this.attributes=m.saveAttrs;m.saveAttrs=this.toJSON();this.attributes=r;if(!d&&!this.cN())return e=m.success,m.success=function(b){var d;m.xhr&&(c.xhr=m.xhr);if(b&&!a.b.xi(b)){d=g.isFunction(h.parse)?h.parse(b):b;h.attributes=g.extend(!0,h.attributes,d);if(m.wait)for(var f in t)d.hasOwnProperty(f)&&
(t[f]=d[f]);h.jo()}a.D.VI(h,b,m);m.wait&&h.set(t);e&&e.call(a.D.yl(m,h),h,b,c);h.ty()},m.attrs||(m.attrs=void 0===t?void 0:l?t:m.saveAttrs),a.D.xD(l?"patch":"update",this,m);f=a.D.C8(m);m.success=function(b){var d;m.xhr&&(c.xhr=m.xhr);if(b&&!a.b.xi(b)){d=g.isFunction(h.parse)?h.parse(b):b;if(!h.vC(d,m,!0))return;h.attributes=g.extend(!0,h.attributes,d);if(m.wait)for(var e in t)d.hasOwnProperty(e)&&(t[e]=d[e]);h.jo()}a.D.VI(h,b,m);m.wait&&h.set(t);f&&f.call(a.D.yl(m,h),h,b,c);h.ty()};m.attrs||(m.attrs=
m.saveAttrs);m.parse=!0;l&&(m.saveAttrs=m.attrs);return a.D.xD("create",this,m)};a.b.g("Model.prototype.save",{save:a.D.prototype.save});a.D.prototype.Gpa=function(a){var c={},d;for(d in this.attributes)this.attributes.hasOwnProperty(d)&&(c[d]=this.attributes[d]);for(d in a)a.hasOwnProperty(d)&&(c[d]=a[d]);return c};a.D.Qr=function(a,c){return a?g.isFunction(a[c])?a[c]():a[c]:g.isFunction(c)?c():c};a.D.i0=function(a){return a&&a.hasOwnProperty("value")&&a.hasOwnProperty("comparator")};a.D.prototype.Kxa=
function(b){for(var c in b)if(b.hasOwnProperty(c)){if(!this.attributes.hasOwnProperty(c))return!1;for(var d=Array.isArray(b[c])?b[c]:[b[c]],e=0;e<d.length;e++)if(a.D.i0(d[e])){var f=d[e].comparator,h=d[e].value;if(a.cb.Re(f))throw Error("String comparator invalid for local where/findWhere");if(!f(this,c,h))return!1}else if(b[c]!==this.attributes[c])return!1}return!0};a.D.prototype.matches=function(a){a:{for(var c in a)if(this.get(c)!==a[c]){a=!1;break a}a=!0}return a};a.b.g("Model.prototype.matches",
{matches:a.D.prototype.matches});a.D.prototype.yka=function(a){a=a.constructor===Array?a:[a];var c;for(c=0;c<a.length;c++)if(this.Kxa(a[c]))return!0;return!1};a.D.C8=function(a){return null!=a&&a.success?a.success:null};a.D.yl=function(a,c){return void 0!==a&&void 0!==a.context?a.context:c};a.D.prototype.cN=function(){return void 0==this.Li()};a.b.g("Model.prototype.isNew",{cN:a.D.prototype.cN});a.D.prototype.lT=function(){return this.idAttribute||"id"};a.D.prototype.Li=function(){return this.id};
a.D.prototype.OX=function(b){if(b){var c={},d;for(d in b)b.hasOwnProperty(d)&&(a.b.dC(b[d],this.attributes[d])||(c[d]=b[d]));return a.b.xi(c)?!1:c}return a.b.xi(this.changed)?!1:this.changed};a.b.g("Model.prototype.changedAttributes",{OX:a.D.prototype.OX});a.D.prototype.UY=function(b){return void 0!==b?a.D.VJ(this.changed)&&this.changed.hasOwnProperty(b):a.D.VJ(this.changed)};a.b.g("Model.prototype.hasChanged",{UY:a.D.prototype.UY});a.D.prototype.destroy=function(b){b=b||{};var c=b.wait,d,e=b.error,
f=this,h,k;k=a.D.jv(b);d=a.D.C8(k);var g=this.nB();k.success=function(e){k.xhr&&(b.xhr=k.xhr);if(g){var h=a.cb.Re(e)&&!a.cb.xi(e)?JSON.parse(e):e;g.Lca(h,null,e,!0)}c&&f.NS();a.D.VI(f,e,k);d&&d.call(a.D.yl(k,f),f,e,b)};k.error=function(c,d,h){f.Lc(!1,a.ka.O.ERROR,f,c,b);e&&e.apply(f,arguments)};if(!this.cN())return h=a.D.xD("delete",this,k),c||this.NS(),h;c||this.NS();d&&d.call(a.D.yl(k,f),f,null,b);return!1};a.b.g("Model.prototype.destroy",{destroy:a.D.prototype.destroy});a.D.prototype.Q6=function(b,
c,d,e){this.Lc(e,a.ka.O.REQUEST,b,c,d)};a.D.prototype.NS=function(){this.Lc(!1,a.ka.O.DESTROY,this,this.collection,null)};a.D.VI=function(b,c,d){b.Lc(!1,a.ka.O.SYNC,b,c,d)};a.D.prototype.toJSON=function(){var a={},c;for(c in this.attributes)this.attributes.hasOwnProperty(c)&&(Array.isArray(this.attributes[c])?a[c]=this.attributes[c].slice(0):a[c]=this.attributes[c]);return a};a.b.g("Model.prototype.toJSON",{toJSON:a.D.prototype.toJSON});a.D.prototype.iG=function(a){return this.UZ[a]};a.b.g("Model.prototype.previous",
{iG:a.D.prototype.iG});a.D.prototype.Kia=function(){return this.UZ};a.b.g("Model.prototype.previousAttributes",{Kia:a.D.prototype.Kia});a.D.prototype.Lr=function(b,c,d){return a.sync(b,c,d)};a.b.g("Model.prototype.sync",{Lr:a.D.prototype.Lr});a.D.xD=function(b,c,d){d=d||{};c.oauth&&(d.oauthHeader=c.oauth.getHeader());!d.dataType&&c.dataType&&(d.dataType=c.dataType);!d.jsonpCallback&&c.jsonpCallback&&(d.jsonpCallback=c.jsonpCallback);if("create"===b||"patch"===b||"update"===b)d.RZ=c.parseSave.call(c,
"patch"===b?d.attrs:d.saveAttrs);var e=null;c instanceof a.D&&(e=c.Li());var f={};if(d)for(var h in d)f[h]=d[h];e=a.D.N0(e,c,d);for(h in e)f[h]=e[h];d.xhr=c.sync(b,c,f);f.xhr&&(d.xhr=f.xhr);return d.xhr};a.D.N0=function(b,c,d){c=c instanceof a.l?c.ila(d):{};b&&(c.recordID=b);return c};a.Lr=function(b,c,d){function e(a){c.Q6(c,a,d,d.silent);return a}d=d||{};var f,h=d.success,k=d.error;f=c.customURL;if("create"===b.valueOf())return b=(b=c.FCa())?b:a.D.Qr(c,"url"),f=new a.Fb(b,f),e(f.sFa(d.RZ,k,d,c));
if("read"===b.valueOf()){if(c instanceof a.D)return b=d.url?d.url:a.D.Qr(c,"url"),f=new a.Fb(b,f),e(f.FY(h,k,c.Li(),d,a.D.yl(d,c)));b=c.a0(d);f=new a.Fb(b,f);return e(f.AHa(h,k,d,c))}f=new a.Fb(a.D.Qr(c,"url"),f);var g=null;c instanceof a.D&&(g=c.Li());return"update"===b.valueOf()?e(f.fka(h,g,d.RZ,k,d,c,!1)):"patch"===b.valueOf()?e(f.fka(h,g,d.RZ,k,d,c,!0)):"delete"===b.valueOf()?e(f.KGa(g,k,d,c)):null};o_("sync",a.Lr,a);a.D.hFa=function(a){if(!a.url)throw Error("The url property or function must be specified");
};a.ajax=function(b){arguments&&0<arguments.length&&a.D.hFa(arguments[0]);return g.ajax.apply(a,arguments)};o_("ajax",a.ajax,a);a.Vr=function(){this.name="URLError";this.message="No URL defined"};o_("URLError",a.Vr,a);a.Vr.prototype=Error();a.Vr.constructor=a.Vr;a.Fb=function(a,c){this.nG=a;this.En=c;g.support.cors=!0};a.Fb.Zx="headers";a.Fb.$E=function(b,c,d){var e;b=g.extend(!0,b,d);for(e in c)c.hasOwnProperty(e)&&"oauthHeader"!==e&&(b.hasOwnProperty(e)||(b[e]=c[e]),e===a.Fb.Zx&&(b[e]=g.extend(!0,
b[e],c[e])));if(c.oauthHeader)for(e in b[a.Fb.Zx]||(b[a.Fb.Zx]={}),c.oauthHeader)c.oauthHeader.hasOwnProperty(e)&&(b[a.Fb.Zx].hasOwnProperty(e)||(b[a.Fb.Zx][e]=c.oauthHeader[e]));return b};a.Fb.prototype.AHa=function(b,c,d,e){d=d||{};var f="jsonp"===d.dataType,h=this.oD("read",this.nG,this.En,null,e,d);b={crossDomain:d.crossDomain||!f,dataType:this.hJ(d),jsonpCallback:d.jsonpCallback,context:null!==e?e:this,success:b,error:c};b=this.VH(b);b=a.Fb.$E(b,d,h);d.xhr=this.ajax(b,e);return d.xhr};a.Fb.prototype.VH=
function(b){b[a.Fb.Zx]={"Accept-Language":this.gj()};return b};a.Fb.prototype.FY=function(b,c,d,e,f){e=e||{};var h="jsonp"===e.dataType;d=this.oD("read",this.nG,this.En,d,f,e);b={crossDomain:e.crossDomain||!h,dataType:this.hJ(e),jsonpCallback:e.jsonpCallback,context:null!==f?f:this,success:b,error:c};b=this.VH(b);b=a.Fb.$E(b,e,d);e.xhr=this.ajax(b,f);return e.xhr};a.Fb.prototype.fka=function(b,c,d,e,f,h,k){f=f||{};var g="jsonp"===f.dataType;c=this.oD(k?"patch":"update",this.nG,this.En,c,h,f);k=a.Fb.Fy(f);
b={crossDomain:f.crossDomain||!g,contentType:this.cua(f),dataType:this.hJ(f),jsonpCallback:f.jsonpCallback,data:this.Ob(JSON.stringify(d),f,c),emulateHTTP:k,emulateJSON:a.Fb.Gy(f),success:b,error:e,context:null!==h?h:this};b=this.VH(b);b=a.Fb.$E(b,f,c);b=a.Fb.j4(k,b);f.xhr=this.ajax(b,h);return f.xhr};a.Fb.j4=function(a,c){if(a){var d=c.beforeSend;c.beforeSend=function(a){a.setRequestHeader("X-HTTP-Method-Override",c.Zl);if(d)return d.apply(this,arguments)}}return c};a.Fb.prototype.Ob=function(b,
c,d){return a.Fb.Gy(c)?(c={_method:d.Zl?d.Zl:d.type},b&&(c.model=b),c):b};a.Fb.prototype.vua=function(b,c){if(c.type)return{method:c.type};var d=null;"create"===b&&(d="POST");"delete"===b&&(d="DELETE");"patch"===b&&(d="PATCH");"update"===b&&(d="PUT");if(a.Fb.Fy(c)){var e={method:"POST"};e.Zl=d;return e}null===d&&(d="GET");return{method:d}};a.Fb.Fy=function(b){return b.emulateHTTP||a.emulateHTTP};a.Fb.Gy=function(b){return b.emulateJSON||a.emulateJSON};a.Fb.prototype.oD=function(b,c,d,e,f,h){var k=
this.vua(b,h);if(g.isFunction(d)){b=d.call(this,b,f,a.D.N0(e,f,h));if(a.cb.Re(b))return c={url:b,type:k.method},k.Zl&&(c.Zl=k.Zl),c;if(b)return b.url=b.hasOwnProperty("url")?b.url:c,b.hasOwnProperty("type")||(b.type=k.method),!b.hasOwnProperty("data")&&k.Zl&&(b.Zl=k.Zl),b}c={url:a.D.Qr(null,c),type:k.method};k.Zl&&(c.Zl=k.Zl);return c};a.Fb.prototype.KGa=function(b,c,d,e){d=d||{};var f="jsonp"===d.dataType;b=this.oD("delete",this.nG,this.En,b,e,d);var h=a.Fb.Fy(d);c={crossDomain:d.crossDomain||!f,
success:d.success,error:c,context:null!==e?e:this,emulateHTTP:h,emulateJSON:a.Fb.Gy(d)};(f=this.Ob(null,d,b))&&(c.data=f);c=a.Fb.$E(c,d,b);c=a.Fb.j4(h,c);d.xhr=this.ajax(c,e);return d.xhr};a.Fb.prototype.sFa=function(b,c,d,e){d=d||{};var f=JSON.stringify(b),h="jsonp"===d.dataType;b=this.oD("create",this.nG,this.En,null,e,d);var k=a.Fb.Fy(d);c={crossDomain:d.crossDomain||!h,contentType:d.contentType||"application/json",dataType:this.hJ(d),jsonpCallback:d.jsonpCallback,data:this.Ob(f,d,b),success:d.success,
error:c,emulateHTTP:k,emulateJSON:a.Fb.Gy(d),context:null!==e?e:this};c=this.VH(c);c=a.Fb.$E(c,d,b);d.xhr=this.ajax(c,e);return d.xhr};a.Fb.prototype.hJ=function(b){return a.Fb.Gy(b)&&!a.Fb.Fy(b)?"application/x-www-form-urlencoded":b.dataType||"json"};a.Fb.prototype.cua=function(b){return a.Fb.Gy(b)&&!a.Fb.Fy(b)?"application/x-www-form-urlencoded":b.contentType||"application/json"};a.Fb.prototype.gj=function(){return a.ga.gj()};a.Fb.prototype.ajax=function(b,c){if(null===b.url||void 0===b.url)throw new a.Vr;
var d=a.ajax(b);c.L3&&c.L3(d);return d};a.Ec=function(b,c){c=c||{};a.Ec._init(this,c,b||"Authorization")};o_("OAuth",a.Ec,a);a.b.sa(a.Ec,a.b,"oj.OAuth");a.Ec.prototype.Init=function(){a.Ec.u.Init.call(this)};a.Ec.prototype.Xfa=function(){var a={};this.st.access_token||this.QX();a[this.ip.Bea]="Bearer "+this.st.access_token;return a};a.b.g("OAuth.prototype.getHeader",{Xfa:a.Ec.prototype.Xfa});a.Ec.prototype.sha=function(){return this.st.PMa?!0:!1};a.b.g("OAuth.prototype.isInitialized",{sha:a.Ec.prototype.sha});
a.Ec.prototype.QX=function(){var b={},c=this;b[c.ip.Bea]="Basic "+a.Ec.Npa(c.ip.client_id+":"+c.ip.client_secret);g.ajax({type:"POST",async:!1,url:this.ip.bearer_url,data:"grant_type\x3dclient_credentials",headers:b,success:function(b){a.Ec.wD(c.st,b)},error:function(a){throw Error(a.responseText);}})};a.b.g("OAuth.prototype.clientCredentialGrant",{QX:a.Ec.prototype.QX});a.Ec.prototype.mja=function(b){a.Ec.wD(this.st,b)};a.b.g("OAuth.prototype.setAccessTokenResponse",{mja:a.Ec.prototype.mja});a.Ec.prototype.Cfa=
function(){return this.st};a.b.g("OAuth.prototype.getAccessTokenResponse",{Cfa:a.Ec.prototype.Cfa});a.Ec.prototype.Lea=function(){a.Ec.O4(this.st)};a.b.g("OAuth.prototype.cleanAccessTokenResponse",{Lea:a.Ec.prototype.Lea});a.Ec.prototype.lja=function(b){a.Ec.wD(this.ip,b)};a.b.g("OAuth.prototype.setAccessTokenRequest",{lja:a.Ec.prototype.lja});a.Ec.prototype.Bfa=function(){return this.ip};a.b.g("OAuth.prototype.getAccessTokenRequest",{Bfa:a.Ec.prototype.Bfa});a.Ec.prototype.Kea=function(){a.Ec.O4(this.ip)};
a.b.g("OAuth.prototype.cleanAccessTokenRequest",{Kea:a.Ec.prototype.Kea});a.Ec._init=function(b,c,d){b.Init();b.ip={};b.st={};c.access_token?a.Ec.wD(b.st,c):c.client_id&&c.client_secret&&c.bearer_url&&a.Ec.wD(b.ip,c);b.ip.Bea=d};a.Ec.wD=function(a,c){var d;c=c||{};for(d in c)a[d]=c[d]};a.Ec.O4=function(a){for(var c in a)a.hasOwnProperty(c)&&"auth_header"!==c&&(a[c]=null,delete a[c])};a.Ec.Npa=function(a){var c,d,e,f,h=0,k=0,g=[];do c=a.charCodeAt(h++),d=a.charCodeAt(h++),e=a.charCodeAt(h++),f=c<<
16|d<<8|e,c=f>>18&63,d=f>>12&63,e=f>>6&63,f&=63,g[k++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".charAt(c)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".charAt(d)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".charAt(e)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".charAt(f);while(h<a.length);g=g.join("");c=a.length%3;return(c?g.slice(0,c-3):g)+"\x3d\x3d\x3d".slice(c||3)};a.l=function(b,c){a.l.JD||
a.l._init(this,b,c,null)};o_("Collection",a.l,a);a.b.sa(a.l,a.b,"oj.Collection");a.l.prototype.au=null;a.b.g("Collection.prototype.model",{au:a.l.prototype.au});a.l.prototype.hia=function(a){var c=this.model;return c&&a?a[c.idAttribute||c.prototype.idAttribute||"id"]:null};a.b.g("Collection.prototype.modelId",{hia:a.l.prototype.hia});a.l.prototype.length=void 0;a.b.g("Collection.prototype.length",{length:a.l.prototype.length});a.l.prototype.jia=void 0;a.b.g("Collection.prototype.models",{jia:a.l.prototype.jia});
a.l.prototype.ed=[];a.l.prototype.url=null;a.b.g("Collection.prototype.url",{url:a.l.prototype.url});a.l.prototype.wt=[];a.b.g("Collection.prototype.changes",{wt:a.l.prototype.wt});a.l.prototype.En=null;a.b.g("Collection.prototype.customURL",{En:a.l.prototype.En});a.l.prototype.gfa=null;a.b.g("Collection.prototype.customPagingOptions",{gfa:a.l.prototype.gfa});a.l.prototype.Dha=void 0;a.b.g("Collection.prototype.lastFetchSize",{Dha:a.l.prototype.Dha});a.l.prototype.Zga=!1;a.b.g("Collection.prototype.hasMore",
{Zga:a.l.prototype.Zga});a.l.prototype.Sja=void 0;a.b.g("Collection.prototype.totalResults",{Sja:a.l.prototype.Sja});a.l.prototype.Cha=void 0;a.b.g("Collection.prototype.lastFetchCount",{Cha:a.l.prototype.Cha});a.l.prototype.iia=-1;a.b.g("Collection.prototype.modelLimit",{iia:a.l.prototype.iia});a.l.prototype.offset=void 0;a.b.g("Collection.prototype.offset",{offset:a.l.prototype.offset});a.l.prototype.rfa=-1;a.b.g("Collection.prototype.fetchSize",{rfa:a.l.prototype.rfa});a.l.prototype.p_=1;a.b.g("Collection.prototype.sortDirection",
{p_:a.l.prototype.p_});a.l.prototype.em=null;a.b.g("Collection.prototype.comparator",{em:a.l.prototype.em});a.l.prototype.Init=function(){a.l.u.Init.call(this)};a.l.extend=function(b,c){a.l.JD=!0;var d=new a.l;a.l.JD=!1;g.extend(d,this.prototype);var e;e=b&&b.constructor&&b.hasOwnProperty("constructor")?b.constructor:function(c,d){a.l._init(this,c,d,b)};if(c)for(var f in c)c.hasOwnProperty(f)&&(e[f]=c[f]);if(b)for(f in b)b.hasOwnProperty(f)&&(d[f]=b[f]);g.extend(e,this);e.prototype=d;e.extend=a.l.extend;
return e.prototype.constructor=e};o_("Collection.extend",a.l.extend,a);a.l._init=function(b,c,d,e){var f,h;b.Init();a.ka.XO(b);if(e)for(f in e)e.hasOwnProperty(f)&&(b[f]=e[f]);d=d||{};h=["comparator","customPagingOptions","customURL",a.l.Jf,"model","modelLimit","sortDirection","url"];for(f=0;f<h.length;f++)d.hasOwnProperty(h[f])&&void 0!==d[h[f]]&&(b[h[f]]=d[h[f]]);void 0===b.Go(null)&&b.$N(-1);void 0===b.modelLimit&&b.i_(-1);b.hasMore=!1;b.km=0;b.lw([],!0);d.parse&&(c=b.parse(c));if(null!=c)for(d.ria=
!0,h=c instanceof Array?c:[c],f=0;f<h.length;f+=1)b.add(h[f],d);b.ap();c||(b.totalResults=void 0);e&&e.initialize&&e.initialize.call(b,c,d)};a.l.prototype.on=function(){};a.l.prototype.Xp=function(){};a.l.prototype.Lc=function(){};a.l.prototype.Q6=function(b,c,d,e){this.Lc(e,a.ka.O.REQUEST,b,c,d)};a.l.prototype.mCa=function(){this.changes=[]};a.l.prototype.lW=function(a,c){for(var d=a;d<a+c;d++)-1===this.changes.indexOf(d)&&(this.changes.push(d),this.changes.sort(function(a,b){return a-b}))};a.l.prototype.lw=
function(a,c){this.models=a;if(c)this.ed=[],this.mCa();else for(var d=0;d<a.length;d++)a[d]&&this.ed.push(d)};a.l.prototype.Yd=function(){return this.models};a.l.prototype.Le=function(){return this.Yd().length};a.l.prototype.yAa=function(a){return a<this.Le()||this.Kb()&&(!this.Ps()||0===this.Le())?!1:!0};a.l.prototype.Ps=function(){return a.l.tq(this.totalResults)};a.l.tq=function(a){return null!=a};a.l.prototype.bBa=function(a){this.Yd().push(a);this.ed.push(this.Le()-1);this.lW(this.Le()-1,1)};
a.l.prototype.cBa=function(a){this.gV(a);this.bBa(a);this.km++;a.BB(this.Le()-1)};a.l.prototype.gba=function(a){if(a)for(var c=0;c<a.length;c++)a[c]&&this.km--};a.l.prototype.sda=function(a,c,d){for(var e=a;e<a+c;e++)this.Kba(this.Tc(e));void 0===d?(this.gba(this.Yd().splice(a,c)),this.rda(a,a+c-1)):(this.gba(this.Yd().splice(a,c,d)),this.rda(a,a+c-1),this.Bya(a),this.gV(d));this.lW(a,c);0>this.km&&(this.km=0);this.fba(a)};a.l.prototype.Tc=function(a){return this.Yd()[a]};a.l.prototype.fba=function(a){for(var c,
d=0;d<this.ed.length;d++)c=this.ed[d],c>=a&&this.Tc(c)&&this.Tc(c).BB(c)};a.l.prototype.Kba=function(a){if(a){var c=a.VZ;a=a.NJa;c?c.iP(a):this.head=a;a?a.UG(c):this.tail=c}};a.l.prototype.gV=function(a){a.iP(this.head);this.head?this.head.UG(a):this.tail=a;a.UG(null);this.head=a};a.l.prototype.tDa=function(a){-1===this.ed.indexOf(a)&&this.ed.push(a)};a.l.prototype.Bya=function(a){for(var c=0;c<this.ed.length;c++)this.ed[c]>=a&&this.ed[c]++;this.ed.push(a)};a.l.prototype.rda=function(a,c){void 0===
c&&(c=a);this.Y4(a,c);for(var d=c-a+1,e=0;e<this.ed.length;e++)this.ed[e]>c&&(this.ed[e]-=d)};a.l.prototype.Y4=function(a,c){void 0===c&&(c=a);for(var d=a;d<=c;d++){var e=this.ed.indexOf(a);-1<e&&this.ed.splice(e,1)}};a.l.prototype.lL=function(a,c){var d=this.Tc(a);this.Kba(d);d||this.km++;this.lW(a,1);if(this.Yd()[a]=c)this.tDa(a),c.BB(a),this.gV(c)};a.l.prototype.Fqa=function(a){var c=this.tail,d,e,f=0;for(this.tail=null;c&&f<a;)d=c.Oka(),(e=this.Tc(d))&&e.UY()?(this.tail||(this.tail=c),c=c.VZ):
(this.km--,-1<d&&(this.lL(d,void 0),this.Y4(d,d)),c.iP(null),c=c.UG(null),f++);this.tail||(this.tail=c);0>this.km&&(this.km=0);0===this.km&&(this.tail=this.head=null)};a.l.prototype.tE=function(){this.km=0;this.tail=this.head=null};a.l.prototype.Vv=function(a){if(this.Kb()){var c=this.a8();-1<c&&this.km+a>c&&this.Fqa(this.km+a-c)}};a.l.prototype.clone=function(){return this.b5(!0)};a.b.g("Collection.prototype.clone",{clone:a.l.prototype.clone});a.l.prototype.b5=function(a){var c=new this.constructor,
d;this.Kb()&&(c=this.hra(c),c.cW());c=this.ira(c);if(a){var e=[];for(a=0;a<this.ed.length;a++)e.push(this.ed[a]);e.sort(function(a,b){return a-b});var f;for(a=0;a<e.length;a++)f=e[a],(d=this.nq(f,null,!0,!1))&&c.lq(d.clone(),{at:f},!0,!1)}return c};a.l.prototype.ira=function(a){var c=["comparator","model","modelId"],d,e;for(e=0;e<c.length;e++)d=c[e],a[d]=this[d];return a};a.l.prototype.hra=function(b){var c=["totalResults","hasMore",a.l.Jf],d,e;for(e=0;e<c.length;e++)d=c[e],b[d]=this[d];return b};
a.l.prototype.sf=function(){return this.length};a.l.prototype.ap=function(){var a=this.Le();this.length=a;this.Kb()||(this.totalResults=a)};a.l.YR=function(a,c,d){return a.model?g.isFunction(a.model)?new a.model(c,d):new a.model.constructor(c,d):null};a.l.prototype.WD=function(b,c,d){var e=null;c=c||{};c.UIa=d;b instanceof a.D?e=b:this.model?e=a.l.YR(this,b,c):(c.collection=this,e=new a.D(b,c));return c.validate&&e.validate&&(b=e.validate(e.attributes))?(c.validationError=b,this.Lc(!1,a.ka.O.INVALID,
e,b,c),null):e};a.l.prototype.add=function(a,c){this.Vv(1);return this.sD(this.lq(a,c,!1,(c||{}).deferred))};a.b.g("Collection.prototype.add",{add:a.l.prototype.add});a.l.prototype.lq=function(b,c,d,e){function f(b,e,h,f,k){var g,l=null;!t&&n&&h?(v=h.ela(e,b.comparator,r),l=h):(t||(g=b.R7(f))&&d&&m!==g.index&&a.t.warn("Duplicate ID fetched or added without merging, the id \x3d "+g.Li()),void 0===g?(void 0===m?(b.cBa(f),q=b.Le()-1,b.Tc(q).TG()):(q=m,b.Kb()&&d?b.lL(q,f):b.sda(q,0,f),b.Tc(q).TG(),m+=
1),void 0===f.nB()&&f.AB(b),b.ap(),b.tza(f),w=!0,l=f):l=g);d&&(c=c||{},c.fillIn=!0);v&&void 0===g&&!u&&void 0===m&&1<b.sf()&&(-1<q&&(p=b.Tc(q).cid),e={},a.Xc.vf(e,c),e.add=!0,b.sort(e),-1<q&&(q=b.Kb()?-1:b.indexOf(b.rY(p),k)));w&&(c.at&&(c.index=q),f?(f.Lc(r,a.ka.O.ADD,f,b,c),y.push(f)):(h.Lc(r,a.ka.O.ADD,h,b,c),y.push(h)));return l}function h(b,e,h){w=!1;var k=b.WD(e,c,!1),g=null,l=null;if(null!=k){q=-1;k.jo();g=e instanceof a.D?e:k;if(h)return t?new Promise(function(a){var c=f(b,g,void 0,k,h);x.push(c);
a(c)}):b.Sk(g,{silent:!0},h,!0).then(function(a){l=a.m;a=f(b,g,l,k,h);x.push(a)});!t&&n&&(l=d?b.R7(g):b.get(g));(e=f(b,g,l,k,h))&&x.push(e)}else x.push(!1)}function k(a,b){return a.parse&&c.parse&&!c.ria?a.parse(b):b}c=c||{};var g=[],m=c.at,r=c.silent,t=c.force,s,q,p,n=c.merge||!1,u=c.sort,v=!0,w=!1,y=[],x=[];void 0!==m&&0>m&&(m+=this.sf()+1);b instanceof Array?g=b:g.push(b);if(!d&&(this.Kb()||e)){var z=this;return new Promise(function(b,d){function e(a){return new Promise(function(b,c){h(z,g[a],
!0).then(function(){b(a+1)},c)})}var f=Promise.resolve(0);g=k(z,g);for(s=0;s<g.length;s++)f=f.then(e);f.then(function(){0<y.length&&z.Lc(c.silent,a.ka.O.ALLADDED,z,y,c);b(a.l.eW(x))},d)})}g=k(this,g);for(s=0;s<g.length;s++)h(this,g[s],!1);0<y.length&&this.Lc(c.silent,a.ka.O.ALLADDED,this,y,c);return a.l.eW(x)};a.l.eW=function(a){return 1===a.length?a[0]:a};a.l.prototype.z9=function(){return a.l.tq(this.comparator)};a.l.prototype.sort=function(b){b=b||{};var c=b.silent,d=this.comparator,e;if(!this.z9())return null;
if(this.Kb()){var f=this.totalResults;this.Ps()?this.lw(Array(f),!0):(this.lw([],!0),this.tE(),this.ap());f=b.add?{add:!0}:null;this.Lc(c,a.ka.O.SORT,this,f,null);c=b.startIndex;return void 0!==c&&null!==c?this.pG(c,this.Go(b)):null}e=this;this.Yd().sort(function(b,c){return a.l.W0(b,c,d,e,e)});this.fba(0);f=b.add?{add:!0}:null;this.Lc(c,a.ka.O.SORT,this,f,null);return null};a.b.g("Collection.prototype.sort",{sort:a.l.prototype.sort});a.l.kc=function(b,c){return b instanceof a.D?b.get(c):a.D.Qr(b,
c)};a.l.W0=function(b,c,d,e,f){var h,k,l;if(g.isFunction(d)){if(1===d.length){h=d.call(f,b);k=d.call(f,c);h=a.cb.Re(h)?h.split(","):[h];var m=a.cb.Re(k)?k.split(","):[k];for(l=0;l<h.length;l++)if(k=a.l.pq(h[l],m[l],e.sortDirection),0!==k)return k}return d.call(f,b,c)}if(a.cb.Re(d))for(d=d.split(","),l=0;l<d.length;l++)if(h=a.l.kc(b,d[l]),k=a.l.kc(c,d[l]),k=a.l.pq(h,k,e.sortDirection),0!==k)return k;return 0};a.l.prototype.Fja=function(b,c){var d=c?c:this.comparator,e;if(!d)return-1;this.mi("sortedIndex");
e=this;return a.l.tta(this.Yd(),b,function(b,c){var k,l;if(g.isFunction(d)){if(1===d.length){k=d.call(e,b);l=d.call(e,c);k=a.cb.Re(k)?k.split(","):[k];l=a.cb.Re(l)?l.split(","):[l];var m,r;for(r=0;r<k.length;r++)if(m=a.l.pq(k[r],l[r],e.sortDirection),0!==m)return m}return d.call(e,b,c)}return a.cb.Re(d)?(k=b.get(d),l=c.get(d),a.l.pq(k,l,e.sortDirection)):0})};a.b.g("Collection.prototype.sortedIndex",{Fja:a.l.prototype.Fja});a.l.tta=function(a,c,d){function e(f,h){var k,g;if(f>h)return-1;k=c.Bu();
g=c.Li();if(a[f].Hu(g,k))return f;if(a[h].Hu(g,k))return h;k=Math.floor((h+f)/2);return-1===d(a[k],c)?e(f+1,k):1===d(a[k],c)?e(k,h-1):k}return e(0,a.length-1)};a.l.pq=function(a,c,d){if(-1===d){if(a<c)return 1;if(c<a)return-1}else{if(a>c)return 1;if(c>a)return-1}return 0};a.l.prototype.unshift=function(b,c){var d={};a.Xc.vf(d,c||{});d.at||(d.at=0);this.Vv(1);return this.sD(this.lq(b,d,!1,d.deferred))};a.b.g("Collection.prototype.unshift",{unshift:a.l.prototype.unshift});a.l.prototype.sD=function(a){return g.isFunction(a.then)?
this.$f(function(){return a}):a};a.l.prototype.shift=function(b){b=b||{};var c=this.$h(b),d;if(this.Kb()||c){var e=this;return this.at(0,b).then(function(c){d=e.hw(c,0,b);e.Lc(b.silent,a.ka.O.ALLREMOVED,e,[d],b);return d})}d=this.hw(this.at(0),0,b);this.Lc(b.silent,a.ka.O.ALLREMOVED,this,[d],b);return d};a.b.g("Collection.prototype.shift",{shift:a.l.prototype.shift});a.l.prototype.XM=function(a){void 0===a&&(a=1);this.mi("initial");var c=[],d;for(d=0;d<this.sf()-a;d+=1)c.push(this.at(d));return c};
a.b.g("Collection.prototype.initial",{XM:a.l.prototype.XM});a.l.prototype.$h=function(a){return(a||{}).deferred};a.l.prototype.last=function(a,c){var d=this.$h(c);void 0===a&&(a=1);if(1===a){var e=this.Le();0===e&&(e=a);return 0<e?this.at(e-1,d):null}var f=[],e=this.sf();if(d||this.Kb()){var h=e-a;0>h&&(h=0);0===e&&(e=a);var k=this;return this.$f(function(){return k.Ex(h,e)})}for(d=e-a;d<e;d+=1)f.push(this.at(d));return f};a.b.g("Collection.prototype.last",{last:a.l.prototype.last});a.l.prototype.Ex=
function(a,c){var d=[],e,f=this;return new Promise(function(h,k){function g(a){return f.Kb()&&f.Ps()&&a>=f.totalResults?Promise.resolve(a+1):new Promise(function(b,c){f.iS(a,null).then(function(c){d.push(c);b(a+1)},c)})}var m=Promise.resolve(a);for(e=a;e<c;e++)m=m.then(g);m.then(function(){h(d)},k)})};a.l.prototype.s7=function(b){return void 0===b||null===b?this[a.l.Jf]:b};a.l.prototype.kqa=function(){var b=this.lastFetchCount;if(void 0===b||null===b)b=this[a.l.Jf];return void 0===this.offset||null===
this.offset?b:this.offset+b};a.l.prototype.next=function(b,c){c=c||{};c[a.l.Jf]=this.s7(b);var d=this.kqa(),e=this.sf();if(0===e&&0<c[a.l.Jf])d=0;else if(d>=e)return c.success&&c.success.call(a.D.yl(c,this),this,null,c),null;c.startIndex=d;return this.fetch(c)};a.b.g("Collection.prototype.next",{next:a.l.prototype.next});a.l.prototype.lqa=function(a){return void 0===this.offset||null===this.offset?0:this.offset-a};a.l.prototype.iG=function(b,c){c=c||{};if(0===this.offset)return c.success&&this.lastFetchCount&&
c.success.call(a.D.yl(c,this),this,null,c),null;c[a.l.Jf]=this.s7(b);var d=this.lqa(c[a.l.Jf]);0>d&&(c[a.l.Jf]=this.offset,d=0);c.startIndex=d;return this.fetch(c)};a.b.g("Collection.prototype.previous",{iG:a.l.prototype.iG});a.l.prototype.i_=function(a){this.modelLimit=a;this.Vv(0)};a.b.g("Collection.prototype.setModelLimit",{i_:a.l.prototype.i_});a.l.prototype.a8=function(){return this.modelLimit};a.l.prototype.$N=function(b){this[a.l.Jf]=b};a.b.g("Collection.prototype.setFetchSize",{$N:a.l.prototype.$N});
a.l.prototype.gja=function(a,c){var d=this.$h(c);void 0===a&&(a=1);var e=[];if(this.Kb()||d){var f=this;return this.$f(function(){return f.Ex(a,f.sf())})}for(d=a;d<this.sf();d+=1)e.push(this.at(d));return e};a.b.g("Collection.prototype.rest",{gja:a.l.prototype.gja});a.l.prototype.remove=function(b,c){c=c||{};var d=[],e;b instanceof Array?d=b:d.push(b);var f=[];for(e=d.length-1;0<=e;e-=1)f.unshift(this.hw(d[e],-1,c));this.Lc(c.silent,a.ka.O.ALLREMOVED,this,d,c);return a.l.eW(f)};a.b.g("Collection.prototype.remove",
{remove:a.l.prototype.remove});a.l.prototype.hw=function(b,c,d){d=d||{};b=-1==c?this.Sk(b):a.l.zq(c,b);var e=d.silent;c=b.index;if(-1<c){var f=b.m;void 0!==f&&f.nB()===this&&f.AB(null);this.sda(c,1);this.ap();var h={};a.Xc.vf(h,d);h.index=c;void 0!==f&&f.Lc(e,a.ka.O.REMOVE,f,this,h);this.Yda(f)}return b.m};a.l.prototype.Yda=function(a){void 0!==a&&a.off(null,null,this)};a.l.prototype.tza=function(b){b.Xp(a.ka.O.ALL,this.Qza,this,!1,!0)};a.l.prototype.Qza=function(b,c,d,e){b===a.ka.O.DESTROY&&this.remove(c);
void 0!==d&&d instanceof a.l&&d!==this||(Array.prototype.slice.call(arguments),this.Lc(e&&e.silent,b,c,d,e))};a.l.prototype.refresh=function(b){b=b||{};var c=this;return this.$f(function(){return new Promise(function(d,e){if(!c.Kb()){var f=void 0!==b.silent&&b.silent;try{c.reset(null,{silent:!0});var h={},k;for(k in b)b.hasOwnProperty(k)&&(h[k]=b[k]);h.success=function(b,e,h){c.Lc(f,a.ka.O.REFRESH,c,h,null);d({collection:b,response:e,options:h})};h.error=function(d,h,f){e(a.l.GC(d,h,f,c,b,!1))};c.fetch(h);
return}catch(g){if(g instanceof a.Vr){c.Lc(f,a.ka.O.REFRESH,c,b,null);d({collection:c,options:b});return}throw g;}}h=b.startIndex;c.lw([],!0);c.tE();c.totalResults=void 0;c.ap();f=void 0!==b.silent&&b.silent;c.Lc(f,a.ka.O.REFRESH,c,b,null);if(void 0===h||null===h)h=0;void 0!==h&&null!==h?c.Qca(h,c.Go(b)).then(function(a){d(a)},function(a){e(a)}):d(void 0)})})};a.b.g("Collection.prototype.refresh",{refresh:a.l.prototype.refresh});a.l.prototype.reset=function(b,c){var d={};a.Xc.vf(d,c||{});d.previousModels=
this.Yd();for(var e,f=0;f<this.ed.length;f++)if(e=this.ed[f],e=this.Tc(e))this.Yda(e),e.AB(null);this.lw([],!0);this.tE();f=void 0!==d.silent&&d.silent;if(!b)return this.ap(),this.totalResults=void 0,this.Lc(f,a.ka.O.RESET,this,d,null),null;e=null;d.parse&&(b=this.parse(b));this.Vv(b instanceof Array?b.length:1);d.ria=!0;e=this.lq(b,d,!0,!1);this.ap();this.Lc(f,a.ka.O.RESET,this,d,null);return this.sD(e)};a.b.g("Collection.prototype.reset",{reset:a.l.prototype.reset});a.l.prototype.at=function(a,
c){return this.nq(a,c,!1,this.$h(c))};a.b.g("Collection.prototype.at",{at:a.l.prototype.at});a.l.prototype.nq=function(a,c,d,e){0>a&&(a+=this.sf());if(0>a||this.yAa(a))return d||!this.Kb()&&!e?null:this.$f(function(){return Promise.resolve(null)});var f=this;return d||!this.Kb()&&!e?this.Tc(a):this.$f(function(){return f.iS(a,c)})};a.l.prototype.whenReady=function(){return this.et?this.et:Promise.resolve()};a.b.g("Collection.prototype.whenReady",{whenReady:a.l.prototype.whenReady});a.l.prototype.$f=
function(b){var c=this;void 0===this.et&&(this.eE=0,this.et=Promise.resolve());this.eE++;return this.et=this.et.then(b.bind(c)).then(function(b){c.eE--;0===c.eE&&(c.et=void 0,c.Lc(!1,a.ka.O.READY,c,null,null));return b},function(a){c.eE--;0===c.eE&&(c.et=void 0);return Promise.reject(a)})};a.l.prototype.L3=function(a){if(a&&a.abort){void 0===this.al&&(this.al=[]);var c=this;a.done(function(){var d=c.al?c.al.indexOf(a):-1;-1<d&&c.al.splice(d,1)});this.al.push(a)}};a.l.prototype.abort=function(){var a=
this;return this.al?new Promise(function(c){for(var d=a.al.length-1;0<=d;d--)a.al[d].then(function(e,f){"abort"===f&&(a.al.splice(d,1),0===a.al.length&&a.whenReady().then(function(){c(null)},function(){c(null)}))},function(){a.al.splice(d,1);0===a.al.length&&a.whenReady().then(function(){c(null)},function(){c(null)})}),a.al[d].abort()}):Promise.resolve()};a.b.g("Collection.prototype.abort",{abort:a.l.prototype.abort});a.l.prototype.iS=function(b,c){var d=this,e=d.Tc(b);return void 0===e?new Promise(function(e,
h){var k={};a.Xc.vf(k,c||{});k.context=d;k.startIndex=b;k.error=function(b,e,f){h(a.l.GC(b,e,f,d,c,!1))};k.success=function(){e(d.Tc(b))};d.Hg(k,-1,!1)}):new Promise(function(a){a(e)})};a.l.prototype.rY=function(a){for(var c=this.Yd(),d,e=null,f=0;f<this.ed.length;f++)if(d=this.ed[f],c[d]&&a===c[d].cid){e=c[d];break}if(e)return e;if(this.Kb())throw Error("Not found locally and not supported by server for virtual collections");return null};a.b.g("Collection.prototype.getByCid",{rY:a.l.prototype.rY});
a.l.prototype.get=function(a,c){var d=this.Sk(a,c,this.$h(c));if(d){if(g.isFunction(d.then))return this.$f(function(){return new Promise(function(a,b){d.then(function(b){a(b.m)},function(a){b(a)})})});if(this.Kb())return this.$f(function(){return new Promise(function(a){a(d.m)})});if(d.hasOwnProperty("m"))return d.m}return null};a.b.g("Collection.prototype.get",{get:a.l.prototype.get});a.l.prototype.R7=function(a){return(a=this.S7(a))?a.m:null};a.l.prototype.S7=function(b){var c=b;b instanceof a.D?
(c=b.Bu(),b=b.Li()):a.l.tq(b)&&void 0!==b.id&&(b=b.id);for(var d=null,e=this.ed.length,f,h=this.Yd(),k,g=0;g<e;g++)if(k=this.ed[g],f=h[k],void 0!==f&&f.Hu(b,c)){d=a.l.zq(k,f);break}return d?d:a.l.zq(-1,void 0)};a.l.prototype.Sk=function(b,c,d,e){var f=b;void 0===e&&(e=!1);b instanceof a.D?(f=b.Bu(),b=b.Li()):a.l.tq(b)&&void 0!==b.id&&(b=b.id);for(var h=null,k=this.Yd(),g,m=0;m<this.ed.length;m++)if(g=this.ed[m],k[g]&&k[g].Hu(b,f)){h=a.l.zq(g,k[g]);break}if(h)return d?new Promise(function(a){a(h)}):
h;if(this.Kb()){if(void 0===b&&void 0!==f)return new Promise(function(b){b(a.l.zq(-1,void 0))});var r=this;return new Promise(function(d,h){var k={};a.Xc.vf(k,c||{});k.context=r;k.startID=b;k.error=function(b,d,e){h(a.l.GC(b,d,e,r,c,!1))};k.success=function(c,e){if(null!=e){var h=r.yT(),k=r.Tc(h);void 0!==k&&k.Hu(b,f)?d(a.l.zq(h,k)):d(a.l.zq(-1,void 0))}else d(a.l.zq(-1,void 0))};r.Hg(k,-1,e)})}var t=a.l.zq(-1,void 0);return d?new Promise(function(a){a(t)}):t};a.l.zq=function(a,c){return{index:a,
m:c}};a.l.prototype.parse=function(a){var c;if(a instanceof Array||!a)return a;for(c in a)if(a.hasOwnProperty(c)&&a[c]instanceof Array)return a[c];return a};a.l.prototype.qqa=function(a,c,d){return this.Ps()&&d.start+d.count>=this.totalResults?!0:d.start===a&&d.count===c};a.l.prototype.pG=function(a,c){var d=this;return this.$f(function(){return d.Qca(a,c)})};a.b.g("Collection.prototype.setRangeLocal",{pG:a.l.prototype.pG});a.l.prototype.Qca=function(a,c){this.Kb()&&this.cW();var d=this.tJ(a,c),e=
this;if(this.qqa(a,c,d))return new Promise(function(a){a(d)});var f=this.a8();-1<f&&f<c&&(this.modelLimit=c);return new Promise(function(d,f){e.Pca(a,c,-1,{start:a,count:c},d,f,!0)})};a.l.prototype.Pca=function(b,c,d,e,f,h,k){var g=this,m=b+c;this[a.l.Jf]&&this[a.l.Jf]>c&&(m=this[a.l.Jf]+b);var r=null;this.Kb()?(r=this.A7(b,m),r>b&&(b=r,m=b+c,this[a.l.Jf]&&this[a.l.Jf]>c&&(m=this[a.l.Jf]+b)),r={context:this,startIndex:b,fetchSize:m-b}):r={context:this};r.error=function(b,c,d){h(a.l.GC(b,c,d,g,null,
!1))};r.success=function(){var a=g.tJ(e.start,e.count);if(k&&g.Ps()&&a.count<e.count){var d=a.start+a.count,m=b+(g.lastFetchCount?g.lastFetchCount:c);m<g.totalResults?g.Pca(m,c,d,e,f,h,k):f(a)}else f(a)};try{this.Hg(r,d,-1<d)}catch(t){t instanceof a.Vr&&(d=g.tJ(b,c),f(d))}};a.l.GC=function(b,c,d,e,f,h){var k=!1;f&&f.silent&&(k=f.silent);h&&a.D.PE(e,k,f,c,d,b);f=Error(c);f.xhr=b;f.error=d;f.collection=e;f.status=c;return f};a.l.prototype.Mua=function(a,c){var d=this.Le();return 0===d?a+c:a+c>d?d:a+
c};a.l.prototype.uha=function(a,c){var d=this.tJ(a,c);return 0===this.Le()?0===c:a===d.start&&(c===d.count||a+c>this.Le())};a.b.g("Collection.prototype.isRangeLocal",{uha:a.l.prototype.uha});a.l.prototype.lD=function(a,c){for(var d=[],e=this.Yd(),f=a+c,h=a;h<f;h++)d.push(e[h]);return d};a.l.prototype.tJ=function(a,c){if(!this.Kb()){if(0<this.Le()){if(a+c>this.Le()){var d=this.Le()-a;return{start:a,count:d,models:this.lD(a,d)}}return{start:a,count:c,models:this.lD(a,c)}}return{start:a,count:0,models:[]}}d=
this.Mua(a,c);if(!this.Ps()&&d<a+c)return{start:a,count:d-a,models:this.lD(a,d-a)};if(0===d)return{start:a,count:0,models:[]};var e=this.A7(a,d);if(-1<e)return{start:a,count:e-a,models:this.lD(a,e-a)};a>d?c=0:a+c>d&&(c=d-a);return{start:a,count:c,models:this.lD(a,c)}};a.l.prototype.A7=function(a,c){for(var d=a;d<c;d++)if(void 0===this.Tc(d))return d;return-1};a.l.prototype.fetch=function(a){var c=this.Hg(a,-1,!1);this.$f(function(){return Promise.resolve(c)});return c};a.b.g("Collection.prototype.fetch",
{fetch:a.l.prototype.fetch});a.l.prototype.Hg=function(b,c,d){function e(a,b,c){a.Kb()?c||a.cW():b.add||b.D_||a.reset(null,{silent:!0})}var f=b||{},h=f.success,k,g=f.error;f.set&&(f.D_=f.set?!0:!1);void 0===f.parse&&(f.parse=!0);k=this;f.error=function(c,d,e){a.D.PE(k,!1,b,d,e,c);g&&g.call(a.D.yl(b,k),c,d,e)};f.success=function(g){var l;try{l=k.parse(g,b)}catch(t){a.l.aL(k,t,f.error,b);return}k.Lca(g,b,l,d);var s=null;if(f.add||k.model){e(k,f,d);try{p=!1,-1===c&&(p=!0,c=k.yT()),s=k.qta(l,c,p,f)}catch(q){a.l.aL(k,
q,f.error,b);return}}else if(!d)if(k.Kb()){e(k,f,d);var p=!1;-1===c&&(p=!0,c=k.yT());s=k.dBa(l,c,p)}else f.D_?k.qW(l,!1,f,!1):k.reset(l,{silent:!0});k.Kb()&&s&&(k.lastFetchCount=s.length);k.Lc(f.silent?!0:!1,a.ka.O.SYNC,k,g,f);h&&h.call(a.D.yl(b,k),k,g,f)};return this.C6(f)};a.l.prototype.dBa=function(a,c,d){var e;if(a){e=a instanceof Array?a:[a];a={};d&&this.Vv(e.length);d=this.Kb();for(var f=null,h=0;h<e.length;h+=1)d&&(a={at:c},f=this.nq(c,null,!0,!1)),a.silent=!0,this.lq(e[h],a,!0,!1),this.nq(c,
null,!0,!1)!==f&&c++}return e};a.l.prototype.qta=function(b,c,d,e){e=e||{};var f=e.parse,h=a.l.YR(this);if(b){var k=b instanceof Array?b:[b];b={};d&&this.Vv(k.length);d=this.Kb();if(e.D_&&!d){for(var g=0;g<k.length;g+=1)c=h&&f?h.parse(k[g]):k[g],k[g]=c;this.qW(k,!1,e,!1)}else{e=null;for(var m=c,g=0;g<k.length;g+=1)c=h&&f?h.parse(k[g]):k[g],d&&(b={at:m},e=this.nq(m,b,!0,!1)),b.silent=!0,this.lq(c,b,!0,!1),this.nq(m,null,!0,!1)!==e&&m++}}return k};a.l.aL=function(b,c,d,e){a.t.error(c.toString());d&&
d.call(a.D.yl(e,b),b,c,e)};a.l.prototype.mta=function(b){var c=b||{},d=c.success,e,f;void 0===c.parse&&(c.parse=!0);f=this;c.success=function(h){var k,g,m=null,r=[];try{k=f.parse(h,b)}catch(t){a.l.aL(f,t,c.error,b);return}if(c.add||f.model)if(g=a.l.YR(f),k)for(m=k instanceof Array?k:[k],k=0;k<m.length;k+=1){if(g&&c.parse)try{e=g.parse(m[k])}catch(s){a.l.aL(f,s,c.error,b);return}else e=m[k];r.push(f.WD(e))}f.Lc(!1,a.ka.O.SYNC,f,h,c);d&&d.call(a.D.yl(b,f),f,r,c)};this.C6(c)};a.l.prototype.C6=function(b){try{return a.D.xD("read",
this,b)}catch(c){throw a.D.PE(this,!1,b,null,c,null),c;}};a.l.prototype.cW=function(){var a=this.totalResults;void 0!==a&&this.Le()!==a&&(this.lw(Array(a),!0),this.tE(),this.ap())};a.l.prototype.Go=function(b){b=b||{};return b[a.l.Jf]||this[a.l.Jf]};a.l.prototype.Kb=function(){return-1<this.Go(null)};a.l.prototype.DJ=function(b,c,d,e,f){b=parseInt(a.l.CJ(b,c,d),10);return void 0===b||null===b||isNaN(b)?e?e:f:b};a.l.prototype.Q4=function(a){return-1===a?void 0:a};a.l.prototype.Lca=function(b,c,d,e){var f=
{};this.customPagingOptions&&((f=this.customPagingOptions.call(this,b))||(f={}));c=c||{};this.lastFetchSize=this.DJ(f,b,"limit",c.fetchSize,this.fetchSize);this.offset=this.DJ(f,b,"offset",c.startIndex,0);this.lastFetchCount=this.DJ(f,b,"count",this.lastFetchCount,this.lastFetchCount);this.totalResults=this.Q4(this.DJ(f,b,"totalResults",this.totalResults,this.totalResults));this.hasMore=this.wua(a.l.CJ(f,b,"hasMore"),this.offset,this.lastFetchSize,this.totalResults);e||(this.totalResults=this.lpa(this.Q4(parseInt(a.l.CJ(f,
b,"totalResults"),10)),this.hasMore,this.offset,parseInt(a.l.CJ(f,b,"count"),10),d&&Array.isArray(d)?d.length:0));!this.Kb()&&this.totalResults&&this.totalResults!==this.lastFetchCount&&this.lastFetchSize&&this.$N(this.lastFetchSize)};a.l.prototype.lpa=function(a,c,d,e,f){return!c&&isNaN(a)?(isNaN(e)?f:e)+d:this.totalResults};a.l.prototype.wua=function(b,c,d,e){return a.l.tq(b)?b:void 0===e||null===e?!0:c+d>e?!1:!0};a.l.CJ=function(a,c,d){return a.hasOwnProperty(d)?a[d]:c?c[d]:void 0};a.l.prototype.yT=
function(){return a.l.tq(this.offset)?this.offset:0};a.l.prototype.create=function(b,c){function d(c,d){c.save(b instanceof a.D?null:b,d);return c}function e(a,b){if(c.wait){if(f.Kb()||h)return f.$f(function(){return Promise.resolve(void 0)})}else return f.add(a,b)}var f=this;c=c||{};var h=this.$h(c),k=this.WD(b,c,!1),g=c.success,m=c.context;c.context=this;c.success=function(a,b,d){d.xhr&&(c.xhr=d.xhr);c.wait&&f.add(k,c);g&&g.call(null!=m?m:f,a,b,c)};if(null==k)return!1;c.forceNew=null!=k.Li();var r=
a.D.jv(c);k.AB(this);if(h||this.Kb())return new Promise(function(a){r.merge=!0;r.deferred=!0;e(k,r).then(function(){c.success=function(b,d,e){e.xhr&&(c.xhr=e.xhr);c.wait?(f.Kb()&&(r.force=!0),f.add(k,r).then(function(){g&&g.call(null!=m?m:f,b,d,c);a(b)})):(g&&g.call(null!=m?m:f,b,d,c),a(b))};var b=d(k,c);b||a(b)})});r.merge=!0;e(k,r);return d(k,c)};a.b.g("Collection.prototype.create",{create:a.l.prototype.create});a.l.prototype.Gia=function(a){var c=[],d;this.mi("pluck");for(d=0;d<this.sf();d+=1)c.push(this.at(d).get(a));
return c};a.b.g("Collection.prototype.pluck",{Gia:a.l.prototype.Gia});a.l.prototype.jka=function(a,c){return this.sD(this.XE(a,c))};a.b.g("Collection.prototype.where",{jka:a.l.prototype.jka});a.l.prototype.XE=function(b,c){c=c||{};var d=this.$h(c),e=this;if(this.Kb())return new Promise(function(d,h){e.mta({query:b,all:!0,success:function(a,b){d(b)},error:function(b,d,f){h(a.l.GC(b,d,f,e,c,!0))}})});var f=[],h,k;for(h=0;h<this.sf();h+=1)k=this.at(h),k.yka(b)&&f.push(k);return d?new Promise(function(a){a(f)}):
f};a.l.prototype.kka=function(b,c){c=c||{};var d=this.$h(c),e=this;if(this.Kb()||d)return e.$f(function(){return new Promise(function(a,d){return e.XE(b,c).then(function(b){b=e.baa(b);a(b)},function(a){d(a)})})});d=this.XE(b,c);d=this.baa(d);d[a.l.Jf]=-1;d.ap();return d};a.b.g("Collection.prototype.whereToCollection",{kka:a.l.prototype.kka});a.l.prototype.baa=function(a){var c=this.b5(!1);c.lw(a,!1);c.tE();c.ap();return c};a.l.prototype.mi=function(a){if(this.Kb())throw Error(a+" not valid on a virtual Collection");
};a.l.prototype.map=function(a,c){var d=[],e;this.mi("map");this.Yd().forEach(function(f){e=a.call(c||this,f);d.push(e)});return d};a.b.g("Collection.prototype.map",{map:a.l.prototype.map});a.l.prototype.each=function(a,c){this.mi("each");this.Yd().forEach(a,c)};a.b.g("Collection.prototype.each",{each:a.l.prototype.each});a.l.prototype.size=function(){return this.sf()};a.b.g("Collection.prototype.size",{size:a.l.prototype.size});a.l.prototype.Dja=function(b,c){var d=[],e;this.mi("sortBy");this.Yd().forEach(function(a){d.push(a)});
e=this;d.sort(function(d,h){var k,l;if(g.isFunction(b))return k=b.call(c||e,d),l=b.call(c||e,h),a.l.pq(k,l,e.sortDirection);k=d.get(b);l=h.get(b);return a.l.pq(k,l,e.sortDirection)});return d};a.b.g("Collection.prototype.sortBy",{Dja:a.l.prototype.Dja});a.l.prototype.Iga=function(a,c){var d={},e;this.mi("groupBy");this.Yd().forEach(function(f){e=g.isFunction(a)?a.call(c||this,f):f.get(a);void 0===d[e]&&(d[e]=[]);d[e].push(f)},this);return d};a.b.g("Collection.prototype.groupBy",{Iga:a.l.prototype.Iga});
a.l.prototype.kha=function(a,c){var d={},e;this.mi("indexBy");this.Yd().forEach(function(f){e=g.isFunction(a)?a.call(c||this,f):f.get(a);d[e]=f},this);return d};a.b.g("Collection.prototype.indexBy",{kha:a.l.prototype.kha});a.l.prototype.min=function(a,c){var d={},e,f;this.mi("min");if(0==this.Le())return null;d=this.Tc(0);e=a.call(c||this,this.Tc(0));this.Yd().forEach(function(h,k){1<=k&&(f=a.call(c||this,h),f<e&&(d=h,e=f))},this);return d};a.b.g("Collection.prototype.min",{min:a.l.prototype.min});
a.l.prototype.max=function(a,c){var d={},e,f;this.mi("max");if(0==this.Le())return null;d=this.Tc(0);e=a.call(c,this.Tc(0));this.Yd().forEach(function(h,k){1<=k&&(f=a.call(c||this,h),f>e&&(d=h,e=f))},this);return d};a.b.g("Collection.prototype.max",{max:a.l.prototype.max});a.l.prototype.filter=function(a,c){var d=[];this.mi("filter");this.Yd().forEach(function(e){a.call(c||this,e)&&d.push(e)});return d};a.b.g("Collection.prototype.filter",{filter:a.l.prototype.filter});a.l.prototype.lka=function(a){var c=
[],d,e,f,h;this.mi("without");for(var k,g=0;g<this.Yd().length;g++){h=!0;k=this.Tc(g);for(d=0;d<arguments.length;d+=1)if(f=arguments[d].Bu(),e=arguments[d].Li(),k.Hu(e,f)){h=!1;break}h&&c.push(k)}return c};a.b.g("Collection.prototype.without",{lka:a.l.prototype.lka});a.l.prototype.jfa=function(a){var c=[],d,e,f,h,k;this.mi("difference");for(var g,m=0;m<this.Yd().length;m++){k=!0;g=this.Tc(m);for(d=0;d<arguments.length;d+=1){for(e=0;e<arguments[d].length;e++)if(h=arguments[d][e].Bu(),f=arguments[d][e].Li(),
g.Hu(f,h)){k=!1;break}if(!k)break}k&&c.push(g)}return c};a.b.g("Collection.prototype.difference",{jfa:a.l.prototype.jfa});a.l.prototype.xi=function(){return 0===this.sf()};a.b.g("Collection.prototype.isEmpty",{xi:a.l.prototype.xi});a.l.prototype.tea=function(a,c){this.mi("any");for(var d,e=0;e<this.Le();e+=1)if(d=this.Tc(e),a.call(c||this,d))return!0;return!1};a.b.g("Collection.prototype.any",{tea:a.l.prototype.tea});a.l.prototype.ufa=function(a,c){var d=this.$h(c),e=this;if(this.Kb()||d)return this.$f(function(){return new Promise(function(d){e.XE(a,
c).then(function(a){a&&0<a.length&&d(a[0]);d(null)})})});d=this.XE(a,c);return 0<d.length?d[0]:null};a.b.g("Collection.prototype.findWhere",{ufa:a.l.prototype.ufa});a.l.prototype.slice=function(a,c,d){var e=this.$h(d);d=[];if(void 0===c){if(this.Kb()&&!this.Ps())throw Error("End must be set for virtual collections with no totalResults");c=this.Le()}if(e||this.Kb()){var f=this;return this.$f(function(){return f.Ex(a,c)})}for(e=a;e<c;e+=1)d.push(this.Tc(e));return d};a.b.g("Collection.prototype.slice",
{slice:a.l.prototype.slice});a.l.prototype.set=function(a,c){return this.qW(a,!0,c,this.$h(c)||this.Kb())};a.b.g("Collection.prototype.set",{set:a.l.prototype.set});a.l.Aba=function(a,c,d,e,f){if(d)for(d=c.length-1;0<=d;d-=1)-1==e.indexOf(d)&&a.hw(c[d],d,f)};a.l.prototype.mEa=function(a,c,d,e){if(this.z9()||!d||!e)return{index:a,u_:!1};d=this.Le();if(a>=d||c>=d)return{index:a,u_:!1};d=this.Tc(a);e=this.Tc(c);this.lL(a,e);e.BB(a);this.lL(c,d);d.BB(c);return{index:c,u_:c!==a}};a.l.prototype.qW=function(b,
c,d,e){d=d||{};var f=void 0===d.add?!0:d.add,h=void 0===d.remove?!0:d.remove,k=void 0===d.merge?!0:d.merge,g=[],m=null,r;c&&(b=this.parse(b));r=Array.isArray(b)?b:[b];if(e){var t=this;return this.$f(function(){return t.jsa(r,t.Yd(),d,h,f,k)})}c=!1;for(b=0;b<r.length;b+=1)if(m=this.cea(this.WD(r[b],d,!0),f,k,e),-1!==m){var m=this.mEa(m,b,h,f),s=m.index;m.u_&&(c=!0);-1===g.indexOf(s)&&g.push(s)}c&&this.Lc(d.silent,a.ka.O.SORT,this,d.add?{add:!0}:null,null);a.l.Aba(this,this.Yd(),h,g,d)};a.l.prototype.jsa=
function(b,c,d,e,f,h){var k=[],g,m=this;return new Promise(function(r,t){function s(a){return new Promise(function(c,e){m.cea(m.WD(b[a],d,!0),f,h,!0).then(function(b){-1!==b&&k.push(b);c(a+1)},e)})}var q=Promise.resolve(0);for(g=0;g<b.length;g+=1)q=q.then(s);q.then(function(){a.l.Aba(m,c,e,k,d);r(void 0)},t)})};a.l.prototype.cea=function(a,c,d,e){function f(e,h,f){var k=h?h.index:-1;if(h&&h.m){if(d){var g={merge:d};if(f)return new Promise(function(c){e.lq(a,g,!1,!0).then(function(){c(k)})});e.add(a,
g)}}else if(c){if(f)return new Promise(function(c){e.lq(a,g,!1,!0).then(function(){c(e.sf()-1)})});e.add(a);k=e.sf()-1}return k}if(e||this.Kb()){var h=this;return new Promise(function(c){h.Sk(a,{silent:!0},e).then(function(a){f(h,a,!0).then(function(a){c(a)})})})}var k=this.Sk(a);return f(this,k,!1)};a.l.prototype.toJSON=function(){var a=[];this.mi("toJSON");this.Yd().forEach(function(c){a.push(c.toJSON())});return a};a.b.g("Collection.prototype.toJSON",{toJSON:a.l.prototype.toJSON});a.l.prototype.first=
function(a,c){var d=this.$h(c),e=this.sf(),f=[];a?e=a:a=1;d=this.Kb()||d;if(1===a){if(d){var h=this;return this.$f(function(){return h.iS(0,null)})}return 0<this.Le()?this.Tc(0):null}e>this.Le()&&(!this.Kb()||this.Ps())&&(e=this.Le());if(d)return h=this,this.$f(function(){return h.Ex(0,e)});for(d=0;d<e;d+=1)f.push(this.Tc(d));return f};a.b.g("Collection.prototype.first",{first:a.l.prototype.first});a.l.prototype.indexOf=function(a,c){var d=this.$h(c);if(this.Kb()||d){var e=this;return this.$f(function(){return e.Sk(a,
null,!0).then(function(a){return a.index})})}return this.Sk(a).index};a.b.g("Collection.prototype.indexOf",{indexOf:a.l.prototype.indexOf});a.l.prototype.contains=function(a,c){var d=this.$h(c);if(this.Kb()||d){var e=this;return this.$f(function(){return e.Sk(a,null,!0).then(function(a){return-1<a.index})})}return-1<this.Sk(a).index};a.b.g("Collection.prototype.contains",{contains:a.l.prototype.contains});a.l.prototype.jha=a.l.prototype.contains;a.b.g("Collection.prototype.include",{jha:a.l.prototype.jha});
a.l.prototype.Cza=function(a){a=this.S7(a);return void 0!==a?a.index:-1};a.l.prototype.pop=function(a){var c=this.$h(a);if(this.Kb()||c){var d=this;return this.at(this.sf()-1,{deferred:c}).then(function(c){d.remove(c,a);return c})}c=this.at(this.sf()-1);this.remove(c,a);return c};a.b.g("Collection.prototype.pop",{pop:a.l.prototype.pop});a.l.prototype.push=function(a,c){var d=this.$h(c);this.Vv(1);return this.sD(this.lq(a,c,!1,d))};a.b.g("Collection.prototype.push",{push:a.l.prototype.push});a.l.prototype.lastIndexOf=
function(b,c){var d;this.mi("lastIndexOf");void 0===c&&(c=0);for(d=this.sf()-1;d>=c;d-=1)if(a.b.dC(b,this.at(d)))return d;return-1};a.b.g("Collection.prototype.lastIndexOf",{lastIndexOf:a.l.prototype.lastIndexOf});a.l.prototype.z8=function(a){return void 0===a?[]:a.split(",")};a.l.fva=function(b){b=Array.isArray(b)?b:[b];var c="",d,e,f,h;for(f=0;f<b.length;f++){d=b[f];for(h in d)if(d.hasOwnProperty(h))for(var k=Array.isArray(d[h])?d[h]:[d[h]],l=0;l<k.length;l++){if(a.D.i0(k[l])){e=k[l].value;var m=
null,m=k[l].comparator,m=g.isFunction(m)?m(null,h,e):m;e=h+m+e}else e=h+"\x3d"+d[h];c+=e+"+"}c=c.substring(0,c.length-1)+","}return","===c.substring(c.length-1)?c.substring(0,c.length-1):c};a.l.prototype.ila=function(b){var c={},d;for(d in b)b.hasOwnProperty(d)&&(c[d]=b[d]);if((b=this.comparator)&&a.cb.Re(b)){b=this.z8(b);for(d=0;d<b.length;d++)c.sort=0===d?b[d]:c.sort+(","+b[d]);c.sortDir=this.B8()}this.Kb()&&(c[a.l.Jf]=this.Go(c));return c};a.l.prototype.Uka=function(){if(g.isFunction(this.customURL))return!0;
var b=this.a0(null);return a.l.tq(b)};a.l.prototype.a0=function(b){var c=a.D.Qr(this,"url");if(this.Kb()){var d=b.all,e=null;e=d?(e=this.totalResults)?e:this.Go(b):this.Go(b);c=c&&-1<c.indexOf("?")?c+"\x26":c+"?";c+="limit\x3d"+e;d||(a.l.tq(b.startIndex)&&(c+="\x26offset\x3d"+b.startIndex),b.startID&&(c+="\x26fromID\x3d"+b.startID),b.since&&(c+="\x26since\x3d"+b.since),b.until&&(c+="\x26until\x3d"+b.until));b.query&&(b=a.l.fva(b.query))&&0<b.length&&(c+="\x26q\x3d"+b);if((b=this.comparator)&&a.cb.Re(b))for(b=
this.z8(b),d=this.B8(),e=0;e<b.length;e++)c=0===e?c+("\x26orderBy\x3d"+b[e]+":"+d):c+(","+b[e]+":"+d);c+="\x26totalResults\x3dtrue"}return c};a.l.prototype.B8=function(){return-1===this.sortDirection?"desc":"asc"};a.l.prototype.Lr=function(b,c,d){return a.sync(b,c,d)};a.b.g("Collection.prototype.sync",{Lr:a.l.prototype.Lr});a.l.Jf="fetchSize"});