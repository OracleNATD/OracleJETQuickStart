/**
 * Copyright (c) 2014, 2016, Oracle and/or its affiliates.
 * The Universal Permissive License (UPL), Version 1.0
 */
"use strict";
/*
 Copyright 2013 jQuery Foundation and other contributors
 Released under the MIT license.
 http://jquery.org/license
*/
define(["ojs/ojcore","jquery","ojs/ojcomponentcore"],function(a,g){(function(){var b=0;a.Pa("oj.ojCollapsible",g.oj.baseComponent,{widgetEventPrefix:"oj",options:{expanded:!1,disabled:null,expandOn:"click",expandArea:"header",beforeExpand:null,expand:null,beforeCollapse:null,collapse:null,optionChange:null},_ComponentCreate:function(){this._super();this.element.addClass("oj-collapsible oj-component");this.Xaa();this.Of();this.Uj=!0;var a=this.element[0];this.CS({type:this.options.expanded?"ojexpand":
"ojcollapse",target:a,currentTarget:a,preventDefault:g.noop});this.Uj=void 0},qh:function(a,b,e){this.rh(b,e,{launcher:this.ZC().first()})},vra:function(){var a=this.options.expanded?"oj-collapsible-open-icon":"oj-collapsible-close-icon";(this.Xl()?g("\x3cspan\x3e"):g("\x3ca href\x3d'#'\x3e")).addClass("oj-component-icon oj-clickable-icon-nocontext oj-collapsible-header-icon "+a).attr("aria-labelledby",this.header.attr("id")).prependTo(this.header)},Y5:function(){this.header.children(".oj-collapsible-header-icon").remove()},
_destroy:function(){this.yo();this.element.removeClass("oj-collapsible oj-component oj-expanded oj-collapsed oj-disabled");this.Xl()&&this.JS(this.header).removeAttr("tabIndex");this.header.removeClass("oj-collapsible-header").each(function(){/^oj-collapsible/.test(this.id)&&this.removeAttribute("id")});this.SC().removeAttr("role").removeAttr("aria-controls").removeAttr("aria-expanded").removeAttr("aria-disabled");this.Y5();this.content.css("display","").removeAttr("aria-hidden").removeAttr("tabIndex").removeClass("oj-component-content oj-collapsible-content").each(function(){/^oj-collapsible/.test(this.id)&&
this.removeAttribute("id")})},yo:function(){this.Lz();this.content&&(a.C.unwrap(this.content),this.Rp=null)},Xl:function(){return this.element.hasClass("oj-disabled")},x7:function(){return"header"==this.options.expandArea?"\x3e .oj-collapsible-header":"\x3e .oj-collapsible-header \x3e .oj-collapsible-header-icon"},ZC:function(){return this.header.find(".oj-collapsible-header-icon")},_setOption:function(a,b,e){"expanded"===a?b!==this.options.expanded&&this.dDa(b):"disabled"===a?(this.header.add(this.header.next()),
this.element.toggleClass("oj-disabled",!!b)):"expandOn"===a||"expandArea"===a?(this.Lz(),this._super(a,b,e),this.Bn()):this._super(a,b,e)},Sv:function(a){if(!a.altKey&&!a.ctrlKey){var b=g.ui.keyCode;switch(a.keyCode){case b.SPACE:case b.ENTER:this.Pda(a)}}},refresh:function(){this._super();this.yo();this.Xaa();this.Y5();this.Of()},Xaa:function(){this.header=this.element.children(":first-child").addClass("oj-collapsible-header");this.content=this.header.next().addClass("oj-collapsible-content oj-component-content");
this.content.wrap("\x3cdiv\x3e\x3c/div\x3e");this.Rp=this.content.parent().addClass("oj-collapsible-wrapper");this.options.disabled&&this.element.addClass("oj-disabled");this.Xl()&&this.JS(this.header).attr("tabIndex",-1)},Of:function(){var a=this.header,d=this.content,e=this.options,f="oj-collapsible-"+(this.element.attr("id")||++b),g=a.attr("id"),k=d.attr("id");g||a.attr("id",f+"-header");k||(k=f+"-content",d.attr("id",k));this.vra();a=this.SC();a.attr("role","button").attr("aria-controls",k).attr("aria-expanded",
e.expanded);this.Xl()&&a.attr("aria-disabled","true");e.expanded?d.removeAttr("aria-hidden"):(this.Rp.css({"max-height":0,"overflow-y":"hidden",display:"none"}),this.Rp.css("max-height",0),d.attr("aria-hidden","true"));this.Bn()},dDa:function(a){a?this.expand(!0):this.collapse(!0)},Bn:function(){var b={keydown:this.Sv},d=this.options.expandOn;if(d){var e=this;g.each(d.split(" "),function(d,g){a.C.eN(g)&&(b[g]=e.Pda)})}d=this.element.find(this.x7());this._on(d,b);this._on(this.Rp,{transitionend:this.Qz,
webkitTransitionEnd:this.Qz,otransitionend:this.Qz,oTransitionEnd:this.Qz});this.Xl()||(this._on(this.element,{ojexpand:this.CS,ojcollapse:this.CS,ojfocus:this.T6,ojfocusout:this.T6}),this._focusable({element:this.ZC(),applyHighlight:!0}),this.We(d),this.Gk(d))},Lz:function(){this._off(this.element.find(this.x7()));this.Rp&&this._off(this.Rp);this._off(this.element.add(this.content))},Pda:function(a){this.Xl()||a.isDefaultPrevented()||(this.options.expanded?this.collapse(!0,a):this.expand(!0,a),a.preventDefault(),
a.stopPropagation(),this.ZC().focus())},CS:function(b){if(!this.Xl()&&b.target===this.element[0]&&(this.Uj||!b.isDefaultPrevented())){var d=this.element,e=this.options,f=this.content,g=this.Rp,k="ojexpand"===b.type;b.preventDefault();this.Uj?(e.expanded=k)?(d.removeClass("oj-collapsed"),d.addClass("oj-expanded"),a.Components.Kr(g[0])):(d.removeClass("oj-expanded"),d.addClass("oj-collapsed"),g.css("max-height",0),g.hide(),a.Components.lu(g[0])):(this.oqa(k,b),g.hM=g.outerHeight(),k?(g.show(),setTimeout(function(){g.hM+=
f.outerHeight();g.addClass("oj-collapsible-transition").css({"max-height":g.hM});d.removeClass("oj-collapsed");d.addClass("oj-expanded");a.Components.Kr(g[0])},1)):(g.removeClass("oj-collapsible-transition"),g.css({"max-height":g.hM,"overflow-y":"hidden"}),setTimeout(function(){g.addClass("oj-collapsible-transition").css({"max-height":0});d.removeClass("oj-expanded");d.addClass("oj-collapsed");a.Components.lu(g[0])},10)));this.ZC().toggleClass("oj-collapsible-open-icon",k).toggleClass("oj-collapsible-close-icon",
!k||!1).end();k?this.content.removeAttr("aria-hidden"):this.content.attr("aria-hidden","true");this.SC().attr("aria-expanded",k)}},T6:function(a){if(this.Xl())return null;"ojfocusout"==a.type?(this.SC().attr("tabIndex",-1),a.preventDefault(),a.stopPropagation()):"ojfocus"==a.type&&(this.SC().attr("tabIndex",0).focus(),a.preventDefault(),a.stopPropagation())},SC:function(){return this.JS(this.header).first()},JS:function(a){return this.Xl()?a.find("span"):a.find("a,:input")},expand:function(a,b){if(!this.Xl()){var e=
{header:this.header,content:this.content};a&&!1===this._trigger("beforeExpand",b,e)||this._trigger("expand",b,e)}},collapse:function(a,b){if(!this.Xl()){var e={header:this.header,content:this.content};a&&!1===this._trigger("beforeCollapse",b,e)||this._trigger("collapse",b,e)}},Qz:function(a){this.Xl()||("max-height"==(a.originalEvent?a.originalEvent.propertyName:null)&&(a.preventDefault(),a.stopPropagation()),this.options.expanded?this.Rp.css({"max-height":9999,"overflow-y":""}):this.Rp.hide(),this.Rp.removeClass("oj-collapsible-transition"))},
oqa:function(a,b){this.option("expanded",a,{_context:{originalEvent:b,Ed:!0,nb:!0}})},getNodeBySubId:function(a){if(null==a)return this.element?this.element[0]:null;switch(a.subId){case "oj-collapsible-content":return this.content[0];case "oj-collapsible-header":return this.header[0];case "oj-collapsible-disclosure":case "oj-collapsible-header-icon":return this.ZC()[0]}return null},getSubIdByNode:function(a){for(var b=this.getNodeBySubId({subId:"oj-collapsible-disclosure"});a;){if(a===this.content[0])return{subId:"oj-collapsible-content"};
if(a===this.header[0])return{subId:"oj-collapsible-header"};if(a===b)return{subId:"oj-collapsible-disclosure"};a=a.parentElement}return null}})})();a.Components.Wa("ojCollapsible","baseComponent",{properties:{disabled:{type:"boolean"},expandArea:{type:"string"},expanded:{type:"boolean"},expandOn:{type:"string"}},methods:{collapse:{},expand:{},refresh:{}},extension:{_widgetName:"ojCollapsible"}});a.Components.register("oj-collapsible",a.Components.getMetadata("ojCollapsible"))});