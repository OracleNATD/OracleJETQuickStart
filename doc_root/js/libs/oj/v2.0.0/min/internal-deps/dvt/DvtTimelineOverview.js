/**
 * Copyright (c) 2014, 2016, Oracle and/or its affiliates.
 * The Universal Permissive License (UPL), Version 1.0
 */
"use strict";
define(['./DvtToolkit', './DvtOverview'], function(dvt) {
  // Internal use only.  All APIs and functionality are subject to change at any time.

  // Map the D namespace to dvt, which is used to provide access across partitions.
  var D = dvt;
  
D.FU=function(a,b,c){this.Init(a,b,c)};(0,D.ca)("DvtTimelineOverview",D.FU);D.w.l(D.FU,D.oo,"DvtTimelineOverview");D.FU.prototype.Init=function(a,b,c){D.FU.o.Init.call(this,a,b,c);a=[D.M.AD(D.M.Dm("#aadd77",0.35)),"#aadd77",D.M.AD(D.M.uo("#aadd77",0.5))];D.WO.Zl()&&(a=["#aadd77"]);this.F5=a;this.lma=(0,D.Sn)();this.st=12};D.FU.prototype.zra=function(){return new D.GU(this)};
D.FU.prototype.Ku=function(a){D.FU.o.Ku.call(this,a);this.Fq=a.eT;this.jn=a.JMa;this.GY=a.vNa;this.G5=a.dqa;this.W5="#267DB3 #68C182 #FAD55C #ED6647 #8561C8 #6DDBDB #FFB54D #E371B2 #47BDEF #A2BF39 #A75DBA #F7F37B".split(" ");a.aw&&(this.vq=new D.F(a.aw));a="solid"==this.A("_","bs")?(0,window.parseInt)(this.A("_","bof"),10):1;var b="solid"==this.A("_as","bs")?(0,window.parseInt)(this.A("_as","bof"),10):1,c="solid"==this.A("_s","bs")?(0,window.parseInt)(this.A("_s","bof"),10):1;this.zX="none"!=this.Fq?
window.Math.max(b,c,a,1)/2+1:1;this.$O=this.Ra()?0:0.75;this.uja=[this.$O,this.$O,this.$O];this.GEa=new D.cg(250,this.F5,this.uja);this.oDa=new D.cg(180,this.F5,this.uja);a=this.Ra()?0:1;this.kAa=new D.I("#aadd77",a)};D.FU.prototype.jD=function(a,b,c,d,e,f){D.FU.o.jD.call(this,a,b,c,d,e,f,this.vq)};D.sU=function(a,b){for(var c="_mrk_"+b,d="_drn_"+b,e=a.Ja(),f=0;f<e;f++){var g=a.ha(f);if(null!=g&&(c==g.getId()||d==g.getId()))return g}return null};D.u=D.FU.prototype;D.u.nH=function(a){return a.getId().substr(5)};
D.u.A=function(a,b){return this.mAa[a+b]};D.u.ja=function(a){return null!=a.Pb?a.Pb.ja():a.ua().pc};D.u.na=function(a){return null!=a.Pb?a.Pb.na():a.ua().nc};D.u.uc=function(a){a=a.uc();null==a&&(a=this.Ra()?(this.Ga-this.AH()-4)/2:1);return a};D.u.yc=function(a){a=a.yc();null==a&&(a=1);return a};
D.u.Aca=function(a,b){D.FU.o.Aca.call(this,a,b);if(null!=this.jn){for(var c=(0,D.HU)(this,this.pb,this.Xb,a,b,this.st),d=[],e=0;e<this.jn.length;e++){var f=this.jn[e];if(null==f.Qh){var g=c,h="_mrk_"+f.getId(),i=f.rb(),k=f.J6,l=f.fba();null==l&&(l=this.$O,0==l&&null!=i&&(l=1));var m=this.uc(f),n=this.yc(f),o=f.sb();if(this.Ra())var o="rectangle",m=2*m,g=2*n,n=f.na()+m/2,p=f.ja()+g/2;else m*=g,g*=n,n=f.ja()+m/2,p=f.na()+g/2;h=new D.$g(this.j(),o,null,n,p,m,g,null,h);h.Pb=f;null==i&&l==this.$O&&null==
k?(k="circle"==o?this.GEa:this.oDa,i=this.kAa):(m=this.F5,null!=i&&(D.WO.Zl()?m=[i]:(m=D.M.Dm(i,0.5),g=D.M.uo(i,0.5),m=[m,i,g])),g=[l,l,l],k=null==k?"circle"==o?new D.cg(250,m,g):new D.cg(180,m,g):new D.vn(i,g[0]),i=new D.I(i,l));h.L(k);h.V(i);"none"!=this.Fq&&h.Jf(!0);i=this.Ja();l=this.ha(i-1);i>this.wq&&("tb"==l.getId()||"arr"==l.getId())?this.Ma(h,i-this.wq):this.k(h);f.Pe(h);this.rn(h,"_");(this.Ra()||"rectangle"==o||"diamond"==o||"triangleUp"==o||"triangleDown"==o||"plus"==o)&&"false"!=this.G5.Eca&&
(0,D.Ai)(h)}else d[d.length]=f}this.C0(d);e=this.j();for(f=this.f8;0<f;f--)for(o=0;o<d.length;o++)i=d[o],f==i.mq&&(k=D.WO.ee(this.pb,this.Xb,i.getTime(),this.Ra()?this.Ua:this.Ga),h="_drn_"+i.getId(),l=9+5*i.mq,m=D.WO.ee(this.pb,this.Xb,i.Qh,this.Ra()?this.Ua:this.Ga),k=this.Ra()?this.kh()?new D.C(e,0,k,l,m-k,h):new D.C(e,this.Ga-l,k,l,m-k,h):this.kh()?new D.C(e,this.Ga-m,this.Ua-l-20,m-k,l,h):new D.C(e,k,this.Ua-l-20,m-k,l,h),k.L(new D.vn(i.zz)),h=new D.I(this.A("_","dbc"),1,1),k.V(h),(0,D.Ai)(k),
k.Pb=i,this.k(k),i.JJ=k,i.pPa=l-2);this.removeChild(this.Woa);this.k(this.Woa);this.st=c}};D.u.C0=function(a){this.f8=0;var b=null;null==this.KJ&&(this.KJ={});for(var c=0;c<a.length;c++){var d=a[c],e=d.getId(),f=e.substring(e.indexOf(":")+1,e.length),f=f.substring(0,f.indexOf(":"));f!=b&&(this.bx=0,b=f);d.mq=(0,D.IU)(this,d,a);null==d.zz&&(null==this.KJ[e]?(this.KJ[e]=this.bx,d.zz=this.W5[this.bx],this.bx++,this.bx==this.W5.length&&(this.bx=0)):d.zz=this.W5[this.KJ[e]])}};
D.u.ZIa=function(){return this.KJ?this.KJ:null};D.FU.prototype.getDurationColorMap=D.FU.prototype.ZIa;
D.HU=function(a,b,c,d,e,f){for(var g,h,i={max:1,T$:[]},k=a.Ra()?e:d,l=0;l<a.jn.length;l++){var m=a.jn[l];if(null!=m.Qh){var n=D.WO.ee(b,c,m.getTime(),k);(0,D.ZO)(a)&&(n=k-n);m.ca(n)}else{var n=a,o=b,p=c,r=k,t=f/2,v=i,y=e,L=t*n.uc(m)+n.zX,J=t*n.yc(m)+n.zX,o=D.WO.ee(o,p,m.getTime(),r);(0,D.ZO)(n)&&(o=r-o-2*L);if(n.Ra())t=0,"solid"==n.A("_","bs")&&(t=(0,window.parseInt)(n.A("_","bw"),10)),r=n.kh()?t+4:n.Ga-2*n.uc(m)-t-4;else for(var r=3,G=0,p=0;1>p;){g=n;h=v;var O=m.sb(),K=o,U=r,da=L,pa=J,ta=t,Aa=y;
"above"==g.ZX&&(U+=(0,D.iP)(g));for(var kb=0;kb<h.T$.length;kb++){var Ha=h.T$[kb],fb=Ha.ja(),yc=Ha.na(),Lb=Ha.sb(),Wd=g.uc(Ha),Ha=g.yc(Ha),fb=window.Math.abs(K-fb),se=ta*Wd+g.zX+da;if(!(fb>=se)&&(Lb="circle"==O&&"circle"==Lb&&da==pa&&Wd==Ha?window.Math.sqrt(se*se-fb*fb):ta*Ha+g.zX+pa,Lb>window.Math.abs(U-yc)&&(U=yc+Lb,G=window.Math.max(G,U+Lb),1<=ta&&void 0!=Aa&&G>Aa)))break}g=U;h=G;g==r&&(p=1);G=h;r=g;p++}m.ca(o);m.va(r);v.T$.push(m);G>v.max&&(v.max=G);if(i.max>e)break}}return i.max>e&&1<f?(0,D.HU)(a,
b,c,d,e,f-1):f};D.IU=function(a,b,c){var d=c.length,e=b.getTime(),f=b.mq;null==f&&(f=1);for(var g=0;g<d;g++){var h=c[g];if(h!=b){var i=h.Qh;if(null!=i){var k=h.getTime(),h=h.mq;null==h&&(h=1);e>=k&&(e<=i&&f==h)&&(f=h+1,b.mq=f,f=(0,D.IU)(a,b,c))}}}f>a.f8&&(a.f8=f);return f};
D.FU.prototype.eU=function(a){var b=D.FU.o.eU.call(this,a);if(null!=b){if(null!=b.Pb){var c=b.Pb.FJ;null!=c&&this.j().fe().aN(a.pageX,a.pageY,c,"#000000");this.GH()&&this.setCursor("pointer")}if("none"!=this.Fq){a=!1;if(null!=this.qk)for(c=0;c<this.qk.length;c++)if(b==this.qk[c]){a=!0;break}a||(a=this.nH(b),c=new D.JU("highlight"),(0,D.zl)(c,"itemId",a),this.dispatchEvent(c),(0,D.KU)(this,b))}}};
D.FU.prototype.dU=function(a){a=D.FU.o.dU.call(this,a);if(null!=a&&!(0,D.vP)(a)){this.j().fe().Ac();var b=!1;if(null!=this.qk)for(var c=0;c<this.qk.length;c++)if(a==this.qk[c]){b=!0;break}b||(b=this.nH(a),c=new D.JU("unhighlight"),(0,D.zl)(c,"itemId",b),this.dispatchEvent(c),(0,D.LU)(this,a))}};
D.FU.prototype.uE=function(a,b,c){b=D.FU.o.uE.call(this,a,b,c);if(null!=b&&(a=a.ctrlKey||a.shiftKey||(0,D.Gf)(),"none"!=this.Fq)){c=this.nH(b);var d=new D.JU("selection");(0,D.zl)(d,"itemId",c);(0,D.zl)(d,"multiSelect",a);this.dispatchEvent(d);a=b.Pb.getTime();null!=a&&(c=new D.JU("scrollTime"),c.setTime(a),this.dispatchEvent(c),a=this.ha(1),b=this.Ra()?this.ja(b)-a.getHeight()/2:this.ja(b)-a.getWidth()/2,(0,D.kP)(this,b))}};
D.KU=function(a,b){if(null!=a.qk)for(var c=0;c<a.qk.length;c++)if(b==a.qk[c])return;a.rn(b,"_h")};D.LU=function(a,b){if(null!=a.qk)for(var c=0;c<a.qk.length;c++)if(b==a.qk[c])return;a.rn(b,"_")};D.tU=function(a,b){null==a.qk&&(a.qk=[]);var c=null;0<a.qk.length&&(c=a.qk[a.qk.length-1]);a.qk.push(b);null!=c&&a.rn(c,"_s");a.rn(b,"_as")};
D.FU.prototype.rn=function(a,b){if(a instanceof D.$g){var c=!1,d=!1;if("solid"==this.A(b,"bs")){var c=!0,e=this.A(b,"bc");null==e&&(e="#000000");var f=this.A(b,"gc");null!=f&&"none"!=f&&(d=!0)}var g=a.sia,h=a.H6;!c&&null!=g?(this.removeChild(g),a.sia=null,null!=h&&(this.removeChild(h),a.H6=null)):!d&&null!=h&&(this.removeChild(h),a.H6=null);var i=a.Ta();if(c){var c=(0,window.parseInt)(this.A(b,"bw"),10),k=(0,window.parseInt)(this.A(b,"bof"),10);if(null==g){if("circle"==i){this.GH()&&(k=0);var l=(a.F().e+
2*k)*a.uc(),m=(a.F().g+2*k)*a.yc(),n=this.ja(a)-k+l/2,o=this.na(a)-k+m/2}else this.Ra()?(l=(a.F().e+(c+1))*a.uc(),m=(a.F().g+(c+1))*a.yc(),n=this.na(a)-(c+1)/2+l/2,o=this.ja(a)-(c+1)/2+m/2):(l=(a.F().e+2*k)*a.uc(),m=(a.F().g+2*k)*a.yc(),n=this.ja(a)-k+l/2,o=this.na(a)-k+m/2);g=new D.$g(this.j(),i,null,n,o,l,m,null,a.getId()+"_border");this.Ma(g,this.Pf(a));a.sia=g;g.L(this.lma)}e=new D.I(e,this.A(b,"bo"),c);g.V(e);(this.Ra()||"rectangle"==i||"diamond"==i||"triangleUp"==i||"triangleDown"==i||"plus"==
i)&&"false"!=this.G5.Eca&&(0,D.Ai)(g);d&&(null==h&&(h=k-c,"circle"==i?(this.GH()&&(h=0),l=(a.F().e+2*h)*a.uc(),m=(a.F().g+2*h)*a.yc(),n=this.ja(a)-h+l/2,o=this.na(a)-h+m/2):this.Ra()?(l=(a.F().e+3)*a.uc(),m=(a.F().g+3)*a.yc(),n=this.na(a)+l/2,o=this.ja(a)-1+m/2):(l=(a.F().e+2*h)*a.uc(),m=(a.F().g+2*h)*a.yc(),n=this.ja(a)-h+l/2,o=this.na(a)-h+m/2),h=new D.$g(this.j(),i,null,n,o,l,m,null,a.getId()+"_glow"),this.Ma(h,this.Pf(g)),a.H6=h,h.L(this.lma)),f=new D.I(f,this.A(b,"go"),4),h.V(f),(this.Ra()||
"rectangle"==i||"diamond"==i||"triangleUp"==i||"triangleDown"==i||"plus"==i)&&"false"!=this.G5.Eca&&(0,D.Ai)(h))}}else if((i=a.getId())&&"_drn_"==i.substring(0,5))i=this.A(b,"dbc"),null==i&&(i="#000000"),f=(0,window.parseInt)(this.A(b,"dbw"),10),a.V(new D.I(i,1,f))};D.FU.prototype.Df=function(){this.Pga||(this.Pga=new D.MU(this));return this.Pga};D.FU.prototype.getAutomation=D.FU.prototype.Df;
D.GU=function(a){this.Init(a)};D.w.l(D.GU,D.w,"DvtTimelineOverviewParser");D.u=D.GU.prototype;D.u.Init=function(a){this.H=a;this.vv=new D.hj};D.u.parse=function(a){var b=this.vv.parse(a);a=this.DE(b);var b=b.xc(),c;if(c=b[0]){var d={};d.width=c.v("width");d.height=c.v("height");d.RNa=c.xc();c=d}else c=null;a.Lta=c;a.JMa=this.T8(b[1],a.dqa);2<b.length&&(a.aIa=!b[2]?null:b[2].xc());return a};
D.u.DE=function(a){var b={};b.start=(0,window.parseInt)(a.v("start"));b.end=(0,window.parseInt)(a.v("end"));b.width=(0,window.parseInt)(a.v("width"));b.Vca=(0,window.parseInt)(a.v("renstart"));b.currentTime=(0,window.parseInt)(a.v("ocd"));b.orientation=a.v("orn");b.eta=a.v("ovp");b.eT=a.v("selmode");b.$ba=a.v("rtl");b.borderTopStyle=a.v("_bts");b.borderTopColor=a.v("_btc");b.vNa=a.v("sid");b.zpa=a.v("_aoc");var c={};c.shape=a.v("_ds");c.$H=a.v("_dsx");c.aI=a.v("_dsy");c.opacity=a.v("_do");c.color=
a.v("_fc");c.Eca=a.v("_ph");b.dqa=c;b.Iba=a.v("_hfc");b.Kba=a.v("_htc");b.Pra=a.v("_hbi");b.asa=a.v("_hw");b.Yra=a.v("_hh");b.xda=a.v("_wbc");b.Fda=a.v("_wbts");b.Dda=a.v("_wbrs");b.zda=a.v("_wbbs");b.Bda=a.v("_wbls");b.Eda=a.v("_wbtc");b.Cda=a.v("_wbrc");b.yda=a.v("_wbbc");b.Ada=a.v("_wblc");b.yca=a.v("_obc");b.eaa=a.v("_ctic");b.qda=a.v("_tic");b.Jta=a.v("_tabc");b.Kta=a.v("_tabo");b.aw=a.v("_ls");c={};c._bs=a.v("_bs");c._bc=a.v("_bc");c._bw=a.v("_bw");c._bof=a.v("_bof");c._bo=a.v("_bo");c._gc=
a.v("_gc");c._go=a.v("_go");c._dbs=a.v("_dbs");c._dbc=a.v("_dbc");c._dbw=a.v("_dbw");c._hbs=a.v("_hbs");c._hbc=a.v("_hbc");c._hbw=a.v("_hbw");c._hbof=a.v("_hbof");c._hbo=a.v("_hbo");c._hgc=a.v("_hgc");c._hgo=a.v("_hgo");c._hdbs=a.v("_hdbs");c._hdbc=a.v("_hdbc");c._hdbw=a.v("_hdbw");c._sbs=a.v("_sbs");c._sbc=a.v("_sbc");c._sbw=a.v("_sbw");c._sbof=a.v("_sbof");c._sbo=a.v("_sbo");c._sgc=a.v("_sgc");c._sgo=a.v("_sgo");c._sdbs=a.v("_sdbs");c._sdbc=a.v("_sdbc");c._sdbw=a.v("_sdbw");c._asbs=a.v("_asbs");
c._asbc=a.v("_asbc");c._asbw=a.v("_asbw");c._asbof=a.v("_asbof");c._asbo=a.v("_asbo");c._asgc=a.v("_asgc");c._asgo=a.v("_asgo");c._asdbs=a.v("_asdbs");c._asdbc=a.v("_asdbc");c._asdbw=a.v("_asdbw");b.WGa=c;return b};D.u.T8=function(a,b){if(!a)return null;for(var c=[],d=a.xc(),e=0;e<d.length;e++){var f=this.S2(d[e],b),f=new D.NU(this.H,f);c.push(f)}return c};
D.u.S2=function(a,b){var c={},d="true"==a.v("_sd");c.id=a.v("tid");c.Yca=a.v("rk");c.time=a.v("t");c.mD=a.v("et");c.shape=a.v("s");d&&null==c.shape&&(c.shape=b.shape);c.IZ=a.v("d");c.color=a.v("c");c.MZ=a.v("dfc");d&&null==c.color&&(c.color=b.color);c.$H=a.v("sx");d&&null==c.$H&&(c.$H=b.$H);c.aI=a.v("sy");d&&null==c.aI&&(c.aI=b.aI);c.$Ka=a.v("g");c.opacity=a.v("o");d&&null==c.opacity&&(c.opacity=b.opacity);return c};
D.NU=function(a,b){this.Init(a,b)};D.w.l(D.NU,D.w,"DvtTimelineOverviewNode");D.u=D.NU.prototype;
D.u.Init=function(a,b){this.H=a;this.UQ=b.Yca;this.Xa=b.id;this.iGa=(0,window.parseInt)(b.time);this.Qh=null==b.mD?null:(0,window.parseInt)(b.mD);this.G="circle";"square"==b.shape?this.G="rectangle":"plus"==b.shape?this.G="plus":"diamond"==b.shape?this.G="diamond":"triangleUp"==b.shape?this.G="triangleUp":"triangleDown"==b.shape&&(this.G="triangleDown");this.FJ=b.IZ;this.fk=b.color;this.J6=b.$Ka;null!=b.opacity&&(this.eEa=(0,window.parseFloat)(b.opacity));null!=b.$H&&(this.OFa=(0,window.parseFloat)(b.$H));
null!=b.aI&&(this.PFa=(0,window.parseFloat)(b.aI));null!=b.MZ&&(this.zz=b.MZ)};D.u.getId=(0,D.s)("Xa");D.u.nba=(0,D.s)("UQ");D.u.getTime=(0,D.s)("iGa");D.u.uc=(0,D.s)("OFa");D.u.yc=(0,D.s)("PFa");D.u.rb=(0,D.s)("fk");D.u.sb=(0,D.s)("G");D.u.fba=(0,D.s)("eEa");D.u.ia=(0,D.s)("ug");D.u.Pe=(0,D.q)("ug");D.u.ja=(0,D.s)("zb");D.u.ca=(0,D.q)("zb");D.u.na=(0,D.s)("Vb");D.u.va=(0,D.q)("Vb");
D.JU=function(a){this.Init("timeline");this.ym=a};D.w.l(D.JU,D.yP,"DvtTimelineOverviewEvent");D.JU.prototype.nH=function(){return this.Wi("itemId")};
D.MU=function(a){this.$b(a)};D.w.l(D.MU,D.zj,"DvtTimelineOverviewAutomation");D.MU.prototype.$b=(0,D.q)("kc");
D.MU.prototype.ol=function(a){var b=a.getId();if(a instanceof D.$g){a=b.split(":");if(4!=a.length)return null;b=null==this.kc.GY?null:this.kc.GY.split(" ");if(null!=b&&(b=D.H.wa(b,a[1]),-1<b))return"marker["+b+"]["+a[2]+"]"}else{if("window"==b)return"range_window";if("lh"==b||"lhb"==b||"lbgrh"==b)return"range_start_handle";if("rh"==b||"rhb"==b||"rbgrh"==b)return"range_end_handle";if("grpy"==b)return a=a.getParent().NR(a),this.ol(a)}return null};
D.MU.prototype.Ff=function(a){for(var b=a.split("["),c=b.length,d=1;d<c;d++){var e=b[d],e=e.substr(0,e.length-1),f=(0,window.parseFloat)(e),e=(0,window.isNaN)(f)?e:f;b[d]=e}if(b&&3==b.length&&"marker"==b[0]){if(c=null==this.kc.GY?null:this.kc.GY.split(" "),null!=c&&(d=(0,window.parseInt)(b[1],10),-1<d&&d<c.length)){a:{a=this.kc.jn;b="tl1:"+c[d]+":"+b[2]+":";for(c=0;c<a.length;c++)if(d=a[c],e=d.getId(),null!=e&&0==e.indexOf(b)){b=d;break a}b=null}return b?b.ia().ta():null}}else{if("range_window"==
a)return this.kc.ha(1).ta();if("range_start_handle"==a)return this.kc.ha(this.kc.Ja()-this.kc.wq).ta();if("range_end_handle"==a)return(0,D.sP)(this.kc).ta()}return null};(0,D.ca)("DvtTimelineOverviewAutomation.prototype.getDomElementForSubId",D.MU.prototype.Ff);

  return D;
});