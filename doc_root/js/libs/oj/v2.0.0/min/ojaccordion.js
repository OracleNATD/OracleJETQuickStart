/**
 * Copyright (c) 2014, 2016, Oracle and/or its affiliates.
 * The Universal Permissive License (UPL), Version 1.0
 */
"use strict";
/*
 Copyright 2013 jQuery Foundation and other contributors
 Released under the MIT license.
 http://jquery.org/license
*/
define(["ojs/ojcore","jquery","ojs/ojcomponentcore","ojs/ojcollapsible"],function(b,f){(function(){b.ya("oj.ojAccordion",f.oj.baseComponent,{widgetEventPrefix:"oj",options:{multiple:!1,expanded:null,beforeExpand:null,expand:null,beforeCollapse:null,collapse:null},_ComponentCreate:function(){this._super();this.element.addClass("oj-accordion oj-component").attr("role","group");this.options.expanded=this.kV(this.options.expanded);this.Od()},pf:function(a,b,c){this.rf(b,c,{launcher:this.element.find(".oj-collapsible-header-icon").first()})},
_destroy:function(){this.element.removeClass("oj-accordion oj-component").removeAttr("role");this.element.children().removeClass("oj-accordion-collapsible");this.element.children(".oj-accordion-created").removeClass("oj-accordion-created").ojCollapsible("destroy")},_setOption:function(a,b,c){if("multiple"===a)!1==b&&!0==this.options.multiple&&this.element.children(".oj-expanded").first().siblings(".oj-collapsible").ojCollapsible("collapse",!1);else if("expanded"===a){this.Eka(b);return}this._super(a,
b,c)},refresh:function(){this._super();this.Od()},Od:function(){this.Eha();this._setOption("disabled",this.options.disabled);this.cY=!0;this._setOption("expanded",this.options.expanded);this.cY=!1;this.Bj()},Eha:function(){this.element.children(":oj-collapsible").each(function(){f(this).ojCollapsible("option","expandArea","header")});this.Nk=this.element.children().not(":oj-ojCollapsible").ojCollapsible({expandArea:"header"}).addClass("oj-accordion-created").end().addClass("oj-accordion-collapsible")},
Bj:function(){var a={keydown:this.Aq,ojbeforeexpand:this.N$,ojexpand:this.Bca,ojbeforecollapse:this.L$,ojcollapse:this.Eaa};this._off(this.Nk);this._on(this.Nk,a)},Aq:function(a){if(!a.altKey&&!a.ctrlKey&&(f(a.target).hasClass("oj-collapsible-header")||f(a.target).hasClass("oj-collapsible-header-icon"))){var b=f.ui.keyCode,c=this.Nk.not(".oj-disabled"),e=c.length,g=f(a.target).closest(".oj-collapsible"),h=c.index(g),k=!1;if(0<=h)switch(a.keyCode){case b.RIGHT:case b.DOWN:k=c[(h+1)%e];break;case b.LEFT:case b.UP:k=
c[(h-1+e)%e];break;case b.HOME:k=c[0];break;case b.END:k=c[e-1]}k&&(g&&f(g).trigger("ojfocusout"),f(k).trigger("ojfocus"),a.preventDefault())}},wV:function(a){return!this.options.multiple&&(a=f(a.target).closest(".oj-collapsible"),a.parent().is(":oj-ojAccordion"))?a.siblings(".oj-collapsible.oj-expanded").map(function(){return f(this).data("oj-ojCollapsible")}):f()},N$:function(a){if(!this.uC(a))return!0;var b,c=this,e;this.wV(a).each(function(){var g=this.element;e=c.zt(g,f(a.target));g={header:g.find(".oj-collapsible-header"),
content:g.find(".oj-collapsible-content")};return b=this._trigger("beforeCollapse",a,g)});e||(e=c.zt(null,f(a.target)));this.options.multiple||this._trigger("beforeExpand",a,e);return b},Bca:function(a,b){if(this.uC(a)&&!this.sI){var c,e=this;this.wV(a).each(function(){this.collapse(!1,a,b);c=e.zt(this.element,f(a.target))});c||(c=e.zt(null,f(a.target)));this.options.multiple||this._trigger("expand",a,c);this.KM()}},L$:function(a,b){return this.uC(a)&&!this.options.multiple?this._trigger("beforeCollapse",
a,this.MX(a,b)):!0},Eaa:function(a,b){if(!this.sI&&this.uC(a)){var c=this.MX(a,b);this.options.multiple||this._trigger("collapse",a,c);this.KM()}},zt:function(a,b){return{fromCollapsible:a,toCollapsible:b}},MX:function(a,b){var c;if(b.toCollapsible)c=b;else{if(a.originalEvent&&a.originalEvent.target){var e=f(a.originalEvent.target);e.hasClass("oj-collapsible")&&(c=this.zt(f(a.target),e))}c||(c=this.zt(f(a.target),null))}return c},uC:function(a){return f(a.target).is(this.Nk)},KM:function(){var a,
d=[];this.Nk.each(function(b){f(this).ojCollapsible("option","expanded")&&(a=f(this).attr("id"),d.push(a?a:b))});b.b.aU(this.options.expanded,d)||this.option("expanded",d,{_context:{Va:!0,Hc:!0}})},kV:function(a){if(Array.isArray(a)){var b,c=[];this.element.children().each(function(e){(b=f(this).attr("id"))?-1!=a.indexOf(b)?c.push(b):-1!=a.indexOf(e)&&c.push(b):-1!=a.indexOf(e)&&c.push(e)});!this.options.multiple&&1<c.length&&(c=[c[c.length-1]]);return c}return null},Eka:function(a){this.cY||(a=this.kV(a));
if(a){var d=this,c,e,g,h=0;this.Nk.each(function(k){c=f(this);e=c.attr("id");g=!1;e?e==a[h]&&(g=!0):k==a[h]&&(g=!0);g&&h++;c.ojCollapsible("option","expanded")!==g&&(b.r.warn("JET Accordion: override collapsible "+k+" expanded setting"),d.sI=!0,c.ojCollapsible("option","expanded",g),d.sI=!1)})}this.KM()},getNodeBySubId:function(a){if(null==a)return this.element?this.element[0]:null;var b=a.subId;a=a.index;if("number"!==typeof a||0>a||a>=this.Nk.length)return null;a=this.Nk[a];switch(b){case "oj-accordion-content":b=
"oj-collapsible-content";break;case "oj-accordion-header":b="oj-collapsible-header";break;case "oj-accordion-disclosure":case "oj-accordion-header-icon":b="oj-collapsible-disclosure";break;case "oj-accordion-collapsible":return a;default:return null}return f(a).ojCollapsible("getNodeBySubId",{subId:b})},getSubIdByNode:function(a){for(var b=-1,c=a;c;){b=Array.prototype.indexOf.call(this.Nk,c);if(-1!=b)break;c=c.parentElement}c=null;if(-1!=b)switch(a=(a=f(this.Nk[b]).ojCollapsible("getSubIdByNode",
a))?a:{},a.subId){case "oj-collapsible-content":c="oj-accordion-content";break;case "oj-collapsible-header":c="oj-accordion-header";break;case "oj-collapsible-disclosure":case "oj-collapsible-header-icon":c="oj-accordion-disclosure";break;default:c="oj-accordion-collapsible"}return c?{subId:c,index:b}:null}})})()});